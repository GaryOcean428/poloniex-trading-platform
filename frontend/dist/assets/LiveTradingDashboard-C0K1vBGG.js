import{r as d,j as e,B as Y,Y as ee,_ as te,S as ae,X as se,I as re,t as ne,v as le,w as ie,$ as oe,a0 as ce,V as de,T as me,G as ue,W as xe,p as he,A as ge,a1 as pe,o as fe}from"./vendor-DsQnMDHq.js";import{C as be,a as ve,b as je,P as ye,c as Ne,p as we,d as ke,e as Se}from"./chartjs-DvSMsvNv.js";import{c as W,a as H,u as G}from"./index-CKZf6eLu.js";import{a as Ce}from"./utils-BDAWB_4D.js";import{R as De,L as Pe,C as Te,X as Ae,Y as J,T as Le,a as $e,b as K}from"./recharts-C046zHnu.js";import{S as Fe,R as Ee}from"./RecentTrades-CYiHn0-D.js";import"./crypto-CVBDpkJt.js";import"./ui-D6B6e0vX.js";const _e=({defaultValue:f,value:t,onValueChange:a,className:r,children:n})=>{const[c,i]=d.useState(t||f||"");d.useEffect(()=>{t!==void 0&&i(t)},[t]);const u=m=>{t===void 0&&i(m),a&&a(m)};return e.jsx("div",{className:W("w-full",r),children:d.Children.map(n,m=>d.isValidElement(m)&&m.type===Z?d.cloneElement(m,{activeTab:c,onTabChange:u}):d.isValidElement(m)&&m.type===U?d.cloneElement(m,{activeTab:c}):m)})},Z=({className:f,children:t,activeTab:a,onTabChange:r})=>e.jsx("div",{className:W("flex border-b",f),children:d.Children.map(t,n=>{if(d.isValidElement(n)&&n.type===B){const c=n;return d.cloneElement(c,{active:a===c.props.value,onSelect:()=>r&&r(c.props.value)})}return n})}),B=({className:f,children:t,active:a,onSelect:r})=>e.jsx("button",{className:W("px-4 py-2 text-sm font-medium",a?"border-b-2 border-primary text-primary":"text-muted-foreground hover:text-foreground",f),onClick:r,children:t}),U=({className:f,value:t,children:a,activeTab:r})=>t!==r?null:e.jsx("div",{className:W("mt-4",f),children:a});var Me=Object.defineProperty,Ie=(f,t,a)=>t in f?Me(f,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):f[t]=a,E=(f,t,a)=>Ie(f,typeof t!="symbol"?t+"":t,a);class Re{constructor(){E(this,"events",{})}on(t,a){this.events[t]||(this.events[t]=[]),this.events[t].push(a)}emit(t,a){this.events[t]&&this.events[t].forEach(r=>{try{r(a)}catch{}})}off(t,a){this.events[t]&&(this.events[t]=this.events[t].filter(r=>r!==a))}}const ze={primarySource:"aggregated",fallbackSources:["poloniex","websocket","rest"],updateInterval:1e3,aggregationMethod:"weighted",enableAnomalyDetection:!0,anomalyThreshold:3,enableDataNormalization:!0,cacheDuration:6e4,maxRetries:3,retryDelay:1e3,enableCompression:!0,logLevel:"info"},X=new Map,P=new Re;class Q{constructor(t={}){E(this,"config"),E(this,"websockets",new Map),E(this,"poloniexRestClient"),E(this,"isRunning",!1),E(this,"retryCount",new Map),E(this,"dataBuffer",new Map),E(this,"lastAnomalyCheck",new Map),E(this,"statisticalBaseline",new Map),this.config={...ze,...t},this.initializePoloniexClient()}getCache(t,a){const r=X.get(t);if(r&&!(typeof a=="number"&&Date.now()-r.timestamp>a))return r.data}setCache(t,a){X.set(t,{data:a,timestamp:Date.now()})}initializePoloniexClient(){this.poloniexRestClient=Ce.create({baseURL:"/api/futures",timeout:1e4,headers:{"Content-Type":"application/json","User-Agent":"PoloniexTradingPlatform/1.0"}})}start(){this.isRunning||(this.isRunning=!0,this.log("info","Starting live data service"),this.initializeWebSockets(),P.emit("service_started",void 0))}stop(){this.isRunning&&(this.isRunning=!1,this.log("info","Stopping live data service"),this.websockets.forEach((t,a)=>{t.close(),this.websockets.delete(a)}),P.emit("service_stopped",void 0))}initializeWebSockets(){try{this.getBulletToken().then(({token:t,endpoint:a})=>{const r=new WebSocket(`${a}?token=${t}`);r.onopen=()=>{this.log("info","Poloniex V3 WebSocket connected"),r.send(JSON.stringify({id:Date.now(),type:"subscribe",topic:"/contractMarket/ticker:BTCUSDTPERP",response:!0})),this.websockets.set("poloniex",r),P.emit("websocket_connected","poloniex")},r.onmessage=n=>{try{const c=JSON.parse(n.data);this.handleWebSocketMessage("poloniex",c)}catch(c){this.log("error",`Error parsing WebSocket message: ${c}`)}},r.onerror=n=>{const c=n instanceof ErrorEvent?n.error:"WebSocket error";this.log("error",`WebSocket error: ${c}`),P.emit("connection_error",{source:"poloniex",error:c})},r.onclose=()=>{if(this.log("info","Poloniex V3 WebSocket disconnected"),this.websockets.delete("poloniex"),this.isRunning){const n=(this.retryCount.get("poloniex")||0)+1;this.retryCount.set("poloniex",n),n<=this.config.maxRetries?setTimeout(()=>this.initializeWebSockets(),this.config.retryDelay*n):P.emit("max_retries_reached","poloniex")}}}).catch(t=>{this.log("error",`Error getting bullet token: ${t}`),P.emit("initialization_error",{error:t})})}catch(t){this.log("error",`Error initializing WebSockets: ${t}`),P.emit("initialization_error",{error:t})}}async getBulletToken(){try{const t=await fetch("https://futures-api.poloniex.com/api/v1/bullet-public",{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to get bullet token: ${t.status}`);const a=await t.json();if(a&&a.data&&a.data.token)return{token:a.data.token,endpoint:a.data.instanceServers[0].endpoint};throw new Error("Invalid bullet token response format")}catch(t){throw this.log("error",`Failed to get bullet token: ${t}`),t}}handleWebSocketMessage(t,a){try{if(typeof a=="object"&&a!==null&&"type"in a&&"data"in a){const r=a;if(r.type==="message"&&r.topic&&r.topic.includes("/contractMarket/ticker")&&r.data){const n=r.data,c=(u,m="0")=>typeof u=="number"?String(u):typeof u=="string"?u:m,i={symbol:typeof n.symbol=="string"?n.symbol:"UNKNOWN",timestamp:Date.now(),open:parseFloat(c(n.open24h)),high:parseFloat(c(n.high24h)),low:parseFloat(c(n.low24h)),close:parseFloat(c(n.price,c(n.lastPrice))),volume:parseFloat(c(n.volume24h)),quoteVolume:parseFloat(c(n.turnover24h)),source:"poloniex_ws_v3"};this.processData(i),this.addToDataBuffer(i)}}P.emit("data_received",{source:t,data:a})}catch(r){this.log("error",`Error handling WebSocket message: ${r}`)}}addToDataBuffer(t){const a=t.symbol;this.dataBuffer.has(a)||this.dataBuffer.set(a,[]);let r=this.dataBuffer.get(a);r||(r=[],this.dataBuffer.set(a,r)),r.push(t),r.length>100&&r.shift();const n=this.lastAnomalyCheck.get(a)||0;Date.now()-n>3e5&&(this.lastAnomalyCheck.set(a,Date.now()),this.updateStatisticalBaseline(a))}updateStatisticalBaseline(t){const a=this.dataBuffer.get(t);if(!a||a.length<30)return;const r=a.map(m=>m.close),n=r.reduce((m,p)=>m+p,0)/r.length,c=r.map(m=>Math.pow(m-n,2)),i=c.reduce((m,p)=>m+p,0)/c.length,u=Math.sqrt(i);this.statisticalBaseline.set(t,{mean:n,stdDev:u,updateTime:Date.now()})}processData(t){try{this.config.enableDataNormalization&&(t=this.normalizeData(t)),this.config.enableAnomalyDetection&&(t=this.detectAnomaly(t));const a=`${t.symbol}_${t.timestamp}`;X.set(a,{data:t,timestamp:Date.now()}),P.emit("data_processed",t)}catch(a){this.log("error",`Error processing data: ${a}`)}}normalizeData(t){const a={...t},r=[a.open,a.high,a.low,a.close].filter(n=>typeof n=="number"&&isFinite(n));return r.length>0&&(a.high=Math.max(...r),a.low=Math.min(...r)),a.normalized=!0,a}detectAnomaly(t){const a=this.statisticalBaseline.get(t.symbol);if(!a)return{...t,isAnomaly:!1,confidence:0};const r=Math.abs((t.close-a.mean)/a.stdDev),n=r>this.config.anomalyThreshold,c=Math.min(r/(this.config.anomalyThreshold*2),1);return{...t,isAnomaly:n,confidence:c}}async fetchMarketData(t,a="1h",r=100){try{const n=`${t}_${a}_${r}`,c=this.getCache(n,this.config.cacheDuration);if(c)return c;const i=await this.poloniexRestClient.get(`/${t}/candles`,{params:{interval:a,limit:r}});if(!i.data)throw new Error("No data received from API");const m=i.data.map(p=>({symbol:t,timestamp:Number(p.timestamp),open:parseFloat(String(p.open||"0")),high:parseFloat(String(p.high||"0")),low:parseFloat(String(p.low||"0")),close:parseFloat(String(p.close||"0")),volume:parseFloat(String(p.volume||"0")),quoteVolume:parseFloat(String(p.quoteVolume||"0")),source:"poloniex_rest"})).map(p=>{let C=p;return this.config.enableDataNormalization&&(C=this.normalizeData(C)),this.config.enableAnomalyDetection&&(C=this.detectAnomaly(C)),C});return this.setCache(n,m),m}catch(n){const c=this.getCache(`${t}_${a}_${r}`,this.config.cacheDuration);if(c)return c;throw n}}async fetchOrderBook(t,a=100){try{const r=`orderbook_${t}_${a}`,n=this.getCache(r,this.config.cacheDuration/10);if(n)return n;const c=await this.poloniexRestClient.get(`/${t}/orderBook`,{params:{limit:a}}),i={symbol:t,timestamp:Date.now(),bids:(c.data.bids||[]).map(u=>({price:parseFloat(u[0]),amount:parseFloat(u[1]),timestamp:Date.now()})),asks:(c.data.asks||[]).map(u=>({price:parseFloat(u[0]),amount:parseFloat(u[1]),timestamp:Date.now()})),source:"poloniex_rest",lastUpdateId:c.data.sequence};return this.setCache(r,i),i}catch(r){const n=this.getCache(`orderbook_${t}_${a}`,this.config.cacheDuration/10);if(n)return n;throw r}}async fetchTrades(t,a=100){try{const r=`trades_${t}_${a}`,n=this.getCache(r,this.config.cacheDuration/10);if(n)return n;const i=((await this.poloniexRestClient.get(`/${t}/trades`,{params:{limit:a}})).data||[]).map(u=>({id:String(u.id||""),symbol:t,timestamp:Number(u.ts||Date.now()),price:parseFloat(String(u.price||"0")),amount:parseFloat(String(u.amount||"0")),side:String(u.takerSide||"").toLowerCase()==="sell"?"buy":"sell",source:"poloniex_rest"}));return this.setCache(r,i),i}catch(r){const n=this.getCache(`trades_${t}_${a}`,this.config.cacheDuration/10);if(n)return n;throw r}}async fetchMarketSummary(t){try{const a=`summary_${t}`,r=this.getCache(a,this.config.cacheDuration/2);if(r)return r;const n=await this.poloniexRestClient.get(`/${t}/ticker24h`),c={symbol:t,timestamp:Date.now(),lastPrice:parseFloat(String(n.data.close||"0")),bidPrice:parseFloat(String(n.data.markPrice||"0")),askPrice:parseFloat(String(n.data.markPrice||"0")),high24h:parseFloat(String(n.data.high||"0")),low24h:parseFloat(String(n.data.low||"0")),volume24h:parseFloat(String(n.data.volume||"0")),quoteVolume24h:parseFloat(String(n.data.quoteVolume||"0")),percentChange24h:parseFloat(String(n.data.change||"0"))*100,source:"poloniex_rest"};return this.setCache(a,c),c}catch(a){const r=this.getCache(`summary_${t}`,this.config.cacheDuration/2);if(r)return r;throw a}}log(t,a){const r={debug:0,info:1,warn:2,error:3};r[t]>=r[this.config.logLevel]&&console[t](`[LiveData] ${a}`)}}const I=new Q,Be=()=>{const[f,t]=d.useState([]),[a,r]=d.useState(null),[n,c]=d.useState([]),[i,u]=d.useState(null),[m,p]=d.useState("BTC_USDT"),[C,F]=d.useState("1h"),[L,b]=d.useState(!1),[T,w]=d.useState(null),[S,k]=d.useState([]),[v,D]=d.useState("stopped"),[g,y]=d.useState({primarySource:"aggregated",fallbackSources:["poloniex","websocket","rest"],updateInterval:1e3,aggregationMethod:"weighted",enableAnomalyDetection:!0,anomalyThreshold:3,enableDataNormalization:!0,cacheDuration:6e4,maxRetries:3,retryDelay:1e3,enableCompression:!0,logLevel:"info"}),x={primary:"#06b6d4",secondary:"#9ca3af",error:"#ef4444"},A=["BTC_USDT","ETH_USDT","SOL_USDT","XRP_USDT","ADA_USDT","DOGE_USDT","MATIC_USDT","DOT_USDT","AVAX_USDT","LINK_USDT"],j=["5m","15m","30m","1h","4h","1d"],M=d.useCallback(async()=>{try{b(!0),w(null);const s=await I.fetchMarketData(m,C,100);t(s);const N=s.filter($=>$.isAnomaly);k(N),b(!1)}catch(s){w(`Failed to fetch market data: ${s instanceof Error?s.message:"Unknown error"}`),b(!1)}},[m,C]),R=d.useCallback(async()=>{try{const s=await I.fetchOrderBook(m);r(s)}catch{}},[m]),z=d.useCallback(async()=>{try{const s=await I.fetchTrades(m,50);c(s)}catch{}},[m]),_=d.useCallback(async()=>{try{const s=await I.fetchMarketSummary(m);u(s)}catch{}},[m]),o=()=>{v==="stopped"?(I.start(),D("running")):(I.stop(),D("stopped"))},l=s=>{const N={...g,...s};y(N),v==="running"&&(I.stop(),new Q(N).start())};d.useEffect(()=>{M(),R(),z(),_();const s=V=>{V.symbol===m&&(t(O=>{const q=[...O,V];return q.length>100?q.slice(-100):q}),V.isAnomaly&&k(O=>[...O,V]))},N=()=>{D("running")},$=()=>{D("stopped")};return P.on("data_processed",s),P.on("service_started",N),P.on("service_stopped",$),()=>{P.off("data_processed",s),P.off("service_started",N),P.off("service_stopped",$)}},[M,R,z,_,m]),d.useEffect(()=>{const s=setInterval(R,1e4),N=setInterval(z,5e3),$=setInterval(_,3e4);return()=>{clearInterval(s),clearInterval(N),clearInterval($)}},[R,z,_]);const h=()=>f.map(s=>({timestamp:new Date(s.timestamp).toLocaleTimeString(),close:s.close,volume:s.volume/1e3,isAnomaly:s.isAnomaly?s.close:null}));return e.jsxs("div",{className:"bg-bg-tertiary rounded-lg shadow-elev-2 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-800 dark:text-white",children:"Advanced Live Data Dashboard"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:o,className:`px-4 py-2 rounded-md text-white ${v==="running"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:v==="running"?"Stop Live Data":"Start Live Data"}),e.jsx("div",{className:"relative",children:e.jsx("select",{"aria-label":"Select symbol",value:m,onChange:s=>p(s.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-neutral-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md dark:bg-neutral-700 dark:border-neutral-600 dark:text-white",children:A.map(s=>e.jsx("option",{value:s,children:s},s))})}),e.jsx("div",{className:"relative",children:e.jsx("select",{"aria-label":"Select timeframe",value:C,onChange:s=>F(s.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-neutral-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md dark:bg-neutral-700 dark:border-neutral-600 dark:text-white",children:j.map(s=>e.jsx("option",{value:s,children:s},s))})}),e.jsx("button",{onClick:M,disabled:L,className:`px-4 py-2 rounded-md text-white ${L?"bg-neutral-400":"bg-blue-600 hover:bg-blue-700"}`,children:L?"Loading...":"Refresh"})]})]}),T&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:T}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-neutral-100 dark:bg-neutral-700 p-4 rounded-md",children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-neutral-700 dark:text-neutral-300",children:"Price"}),e.jsxs("div",{className:"text-3xl font-bold text-neutral-800 dark:text-white",children:["$",i.lastPrice.toFixed(2)]}),e.jsxs("div",{className:`text-sm font-medium ${i.percentChange24h>=0?"text-green-600":"text-red-600"}`,children:[i.percentChange24h>=0?"+":"",i.percentChange24h.toFixed(2),"%"]})]}),e.jsxs("div",{className:"bg-neutral-100 dark:bg-neutral-700 p-4 rounded-md",children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-neutral-700 dark:text-neutral-300",children:"24h Range"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"Low"}),e.jsxs("div",{className:"text-lg font-semibold text-neutral-800 dark:text-white",children:["$",i.low24h.toFixed(2)]})]}),e.jsx("div",{className:"w-full mx-4",children:e.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2.5 dark:bg-neutral-600",children:e.jsx("div",{className:"h-2.5 rounded-full bg-blue-600",style:{width:`${((i.lastPrice-i.low24h)/(i.high24h-i.low24h)*100).toFixed(0)}%`}})})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"High"}),e.jsxs("div",{className:"text-lg font-semibold text-neutral-800 dark:text-white",children:["$",i.high24h.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"bg-neutral-100 dark:bg-neutral-700 p-4 rounded-md",children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-neutral-700 dark:text-neutral-300",children:"24h Volume"}),e.jsx("div",{className:"text-3xl font-bold text-neutral-800 dark:text-white",children:i.volume24h.toLocaleString(void 0,{maximumFractionDigits:2})}),e.jsxs("div",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:["$",i.quoteVolume24h.toLocaleString(void 0,{maximumFractionDigits:2})]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-neutral-700 dark:text-neutral-300",children:"Price Chart"}),e.jsx("div",{className:"h-80 bg-neutral-50 dark:bg-neutral-700 p-4 rounded-md",children:f.length>0?e.jsx(De,{width:"100%",height:"100%",children:e.jsxs(Pe,{data:h(),margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Te,{strokeDasharray:"3 3"}),e.jsx(Ae,{dataKey:"timestamp"}),e.jsx(J,{yAxisId:"left"}),e.jsx(J,{yAxisId:"right",orientation:"right"}),e.jsx(Le,{}),e.jsx($e,{}),e.jsx(K,{yAxisId:"left",type:"monotone",dataKey:"close",stroke:x.primary,dot:!1,activeDot:{r:8}}),e.jsx(K,{yAxisId:"right",type:"monotone",dataKey:"volume",stroke:x.secondary,dot:!1}),e.jsx(K,{yAxisId:"left",type:"monotone",dataKey:"isAnomaly",stroke:x.error,strokeWidth:0,dot:{r:6,fill:x.error}})]})}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-neutral-500 dark:text-neutral-400",children:"No data available"})})})]}),e.jsxs(_e,{defaultValue:"order-book",children:[e.jsxs(Z,{children:[e.jsx(B,{value:"order-book",children:"Order Book"}),e.jsx(B,{value:"recent-trades",children:"Recent Trades"}),e.jsx(B,{value:"anomalies",children:"Anomalies"}),e.jsx(B,{value:"configuration",children:"Configuration"})]}),e.jsx(U,{value:"order-book",children:a?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-2 text-green-600",children:"Bids"}),e.jsx("div",{className:"overflow-y-auto max-h-60",children:e.jsxs("table",{className:"min-w-full divide-y divide-neutral-200 dark:divide-neutral-700",children:[e.jsx("thead",{className:"bg-neutral-50 dark:bg-neutral-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Total"})]})}),e.jsx("tbody",{className:"bg-bg-tertiary divide-y divide-border-subtle",children:a.bids.map((s,N)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-green-600",children:s.price.toFixed(2)}),e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-neutral-500 dark:text-neutral-400",children:s.amount.toFixed(6)}),e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-neutral-500 dark:text-neutral-400",children:(s.price*s.amount).toFixed(2)})]},N))})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-2 text-red-600",children:"Asks"}),e.jsx("div",{className:"overflow-y-auto max-h-60",children:e.jsxs("table",{className:"min-w-full divide-y divide-neutral-200 dark:divide-neutral-700",children:[e.jsx("thead",{className:"bg-neutral-50 dark:bg-neutral-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Total"})]})}),e.jsx("tbody",{className:"bg-bg-tertiary divide-y divide-border-subtle",children:a.asks.map((s,N)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-red-600",children:s.price.toFixed(2)}),e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-neutral-500 dark:text-neutral-400",children:s.amount.toFixed(6)}),e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-neutral-500 dark:text-neutral-400",children:(s.price*s.amount).toFixed(2)})]},N))})]})})]})]}):e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx("p",{className:"text-neutral-500 dark:text-neutral-400",children:"No order book data available"})})}),e.jsx(U,{value:"recent-trades",children:n.length>0?e.jsx("div",{className:"overflow-y-auto max-h-60",children:e.jsxs("table",{className:"min-w-full divide-y divide-neutral-200 dark:divide-neutral-700",children:[e.jsx("thead",{className:"bg-neutral-50 dark:bg-neutral-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Side"})]})}),e.jsx("tbody",{className:"bg-bg-tertiary divide-y divide-border-subtle",children:n.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-neutral-500 dark:text-neutral-400",children:new Date(s.timestamp).toLocaleTimeString()}),e.jsx("td",{className:`px-6 py-2 whitespace-nowrap text-sm font-medium ${s.side==="buy"?"text-green-600":"text-red-600"}`,children:s.price.toFixed(2)}),e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-neutral-500 dark:text-neutral-400",children:s.amount.toFixed(6)}),e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.side==="buy"?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100"}`,children:s.side.toUpperCase()})})]},s.id))})]})}):e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx("p",{className:"text-neutral-500 dark:text-neutral-400",children:"No trade data available"})})}),e.jsx(U,{value:"anomalies",children:S.length>0?e.jsx("div",{className:"overflow-y-auto max-h-60",children:e.jsxs("table",{className:"min-w-full divide-y divide-neutral-200 dark:divide-neutral-700",children:[e.jsx("thead",{className:"bg-neutral-50 dark:bg-neutral-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Confidence"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 dark:text-neutral-300 uppercase tracking-wider",children:"Type"})]})}),e.jsx("tbody",{className:"bg-bg-tertiary divide-y divide-border-subtle",children:S.map((s,N)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-neutral-500 dark:text-neutral-400",children:new Date(s.timestamp).toLocaleString()}),e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-neutral-800 dark:text-white",children:s.close.toFixed(2)}),e.jsxs("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-neutral-500 dark:text-neutral-400",children:[e.jsx("div",{className:"w-full bg-neutral-200 rounded-full h-2.5 dark:bg-neutral-700",children:e.jsx("div",{className:"h-2.5 rounded-full bg-red-600",style:{width:`${((s.confidence||0)*100).toFixed(0)}%`}})}),e.jsxs("span",{className:"text-xs",children:[((s.confidence||0)*100).toFixed(0),"%"]})]}),e.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100",children:"PRICE ANOMALY"})})]},N))})]})}):e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx("p",{className:"text-neutral-500 dark:text-neutral-400",children:"No anomalies detected"})})}),e.jsx(U,{value:"configuration",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-4 text-neutral-700 dark:text-neutral-300",children:"Data Sources"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Primary Source"}),e.jsxs("select",{"aria-label":"Primary Source",value:g.primarySource,onChange:s=>l({primarySource:s.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-neutral-700 dark:border-neutral-600 dark:text-white",children:[e.jsx("option",{value:"poloniex",children:"Poloniex API"}),e.jsx("option",{value:"websocket",children:"WebSocket"}),e.jsx("option",{value:"aggregated",children:"Aggregated (Multiple Sources)"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Aggregation Method"}),e.jsxs("select",{"aria-label":"Aggregation Method",value:g.aggregationMethod,onChange:s=>l({aggregationMethod:s.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-neutral-700 dark:border-neutral-600 dark:text-white",children:[e.jsx("option",{value:"weighted",children:"Weighted Average"}),e.jsx("option",{value:"median",children:"Median"}),e.jsx("option",{value:"mean",children:"Mean"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Update Interval (ms)"}),e.jsx("input",{"aria-label":"Update Interval (ms)",type:"number",min:"100",max:"10000",step:"100",value:g.updateInterval,onChange:s=>l({updateInterval:parseInt(s.target.value)}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-neutral-700 dark:border-neutral-600 dark:text-white"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-4 text-neutral-700 dark:text-neutral-300",children:"Data Processing"}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{type:"checkbox",id:"enableAnomalyDetection",checked:g.enableAnomalyDetection,onChange:s=>l({enableAnomalyDetection:s.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-neutral-300 rounded"}),e.jsx("label",{htmlFor:"enableAnomalyDetection",className:"ml-2 block text-sm text-neutral-700 dark:text-neutral-300",children:"Enable Anomaly Detection"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Anomaly Threshold (standard deviations)"}),e.jsx("input",{"aria-label":"Anomaly Threshold (standard deviations)",type:"number",min:"1",max:"10",step:"0.1",value:g.anomalyThreshold,onChange:s=>l({anomalyThreshold:parseFloat(s.target.value)}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-neutral-700 dark:border-neutral-600 dark:text-white"})]}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{type:"checkbox",id:"enableDataNormalization",checked:g.enableDataNormalization,onChange:s=>l({enableDataNormalization:s.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-neutral-300 rounded"}),e.jsx("label",{htmlFor:"enableDataNormalization",className:"ml-2 block text-sm text-neutral-700 dark:text-neutral-300",children:"Enable Data Normalization"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-1",children:"Log Level"}),e.jsxs("select",{"aria-label":"Log Level",value:g.logLevel,onChange:s=>l({logLevel:s.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-neutral-700 dark:border-neutral-600 dark:text-white",children:[e.jsx("option",{value:"debug",children:"Debug"}),e.jsx("option",{value:"info",children:"Info"}),e.jsx("option",{value:"warn",children:"Warning"}),e.jsx("option",{value:"error",children:"Error"})]})]})]})]})})]})]})},Ue=({maxAlerts:f=50,soundEnabled:t=!0,onAlertClick:a})=>{const{isConnected:r,on:n,off:c}=H(),{activeStrategies:i}=G(),[u,m]=d.useState([]),[p,C]=d.useState(t),[F,L]=d.useState(!1),[b,T]=d.useState({priceChange:{enabled:!0,threshold:5},volumeSpike:{enabled:!0,threshold:3},portfolioChange:{enabled:!0,threshold:2},strategyStop:{enabled:!0},connectionIssues:{enabled:!0}}),w=d.useCallback((o,l,h,s,N="medium",$)=>({id:`alert-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,type:o,category:l,title:h,message:s,timestamp:Date.now(),priority:N,acknowledged:!1,data:$}),[]),S=d.useCallback(o=>{m(l=>{const h=[o,...l];return h.length>f?h.slice(0,f):h}),p&&(o.priority==="high"||o.priority==="critical")&&k(o.type)},[f,p]),k=o=>{try{const l=window.AudioContext||window.webkitAudioContext;if(!l)return;const h=new l,s=h.createOscillator(),N=h.createGain();s.connect(N),N.connect(h.destination);const $={success:800,info:600,warning:400,error:200};s.frequency.value=$[o],s.type="sine",N.gain.setValueAtTime(.3,h.currentTime),N.gain.exponentialRampToValueAtTime(.01,h.currentTime+.5),s.start(h.currentTime),s.stop(h.currentTime+.5)}catch{}},v=d.useCallback((...o)=>{const l=o[0];if(!b.priceChange.enabled)return;const h=Math.abs(l.changePercent||0);if(h>=b.priceChange.threshold){const s=w(h>=10?"error":"warning","market","Significant Price Movement",`${l.pair} moved ${l.changePercent>0?"+":""}${l.changePercent.toFixed(2)}%`,h>=10?"high":"medium",l);S(s)}},[b.priceChange,w,S]),D=d.useCallback((...o)=>{const l=o[0],h=(l.profit||0)>0,s=w(h?"success":"error","trade","Trade Executed",`${l.side?.toUpperCase()||"TRADE"} ${l.amount||0} ${l.pair||""} ${h?`+$${l.profit?.toFixed(2)||"0.00"}`:`$${l.profit?.toFixed(2)||"0.00"}`}`,h?"low":"medium",l);S(s)},[w,S]),g=d.useCallback((...o)=>{const l=o[0];if(b.connectionIssues.enabled){if(l==="disconnected"||l==="failed"){const h=w("error","system","Connection Lost","WebSocket connection lost. Trading may be affected.","high");S(h)}else if(l==="connected"){const h=w("success","system","Connected","WebSocket connection restored.","low");S(h)}}},[b.connectionIssues,w,S]);d.useEffect(()=>{if(r)return n("marketData",v),n("tradeExecuted",D),n("connectionStateChanged",g),()=>{c("marketData",v),c("tradeExecuted",D),c("connectionStateChanged",g)}},[r,v,D,g,n,c]),d.useEffect(()=>{if(!b.strategyStop.enabled)return;const o=u.filter(h=>h.category==="strategy").length,l=i.length;if(o>l){const h=w("warning","strategy","Strategy Stopped",`A trading strategy has stopped. ${l} strategies still active.`,"medium");S(h)}},[i.length,b.strategyStop,w,S,u]);const y=o=>{m(l=>l.map(h=>h.id===o?{...h,acknowledged:!0}:h))},x=o=>{m(l=>l.filter(h=>h.id!==o))},A=()=>{m([])},j=()=>{m(o=>o.map(l=>({...l,acknowledged:!0})))},M=o=>{switch(o.type){case"success":return e.jsx(ie,{className:"h-5 w-5 text-green-500"});case"warning":return e.jsx(le,{className:"h-5 w-5 text-yellow-500"});case"error":return e.jsx(ne,{className:"h-5 w-5 text-red-500"});case"info":default:return e.jsx(re,{className:"h-5 w-5 text-blue-500"})}},R=o=>{const l=o.acknowledged?"opacity-50 ":"";switch(o.type){case"success":return l+"bg-green-50 border-green-200";case"warning":return l+"bg-yellow-50 border-yellow-200";case"error":return l+"bg-red-50 border-red-200";case"info":default:return l+"bg-blue-50 border-blue-200"}},z=o=>{switch(o){case"critical":return"bg-error/10 text-error border border-error/20";case"high":return"bg-warning/10 text-warning border border-warning/20";case"medium":return"bg-warning/10 text-warning border border-warning/20";case"low":default:return"bg-bg-secondary text-text-secondary border border-border-subtle"}},_=u.filter(o=>!o.acknowledged).length;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{className:"h-5 w-5 text-text-secondary"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Real-time Alerts"}),_>0&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold bg-error/10 text-error border border-error/20",children:[_," new"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>C(!p),className:`p-2 rounded-md transition-colors ${p?"bg-brand-cyan/10 text-brand-cyan hover:bg-brand-cyan/20":"bg-bg-secondary text-text-muted hover:bg-bg-tertiary"}`,title:p?"Disable sound":"Enable sound",children:p?e.jsx(ee,{className:"h-4 w-4"}):e.jsx(te,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>L(!F),className:"p-2 rounded-md bg-bg-secondary text-text-secondary hover:bg-bg-tertiary transition-colors",title:"Alert settings",children:e.jsx(ae,{className:"h-4 w-4"})}),_>0&&e.jsx("button",{onClick:j,className:"px-3 py-1 text-sm bg-brand-cyan/10 text-brand-cyan rounded-md hover:bg-brand-cyan/20 transition-colors font-medium",children:"Acknowledge All"}),u.length>0&&e.jsx("button",{onClick:A,className:"px-3 py-1 text-sm bg-error/10 text-error rounded-md hover:bg-error/20 transition-colors font-medium",children:"Clear All"})]})]}),F&&e.jsxs("div",{className:"p-4 bg-bg-secondary rounded-md border border-border-subtle",children:[e.jsx("h4",{className:"text-md font-semibold mb-3 text-text-primary",children:"Alert Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:b.priceChange.enabled,onChange:o=>T(l=>({...l,priceChange:{...l.priceChange,enabled:o.target.checked}})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Price change alerts"})]}),b.priceChange.enabled&&e.jsx("input",{type:"number",min:"1",max:"50",value:b.priceChange.threshold,onChange:o=>T(l=>({...l,priceChange:{...l.priceChange,threshold:parseFloat(o.target.value)}})),className:"mt-1 block w-full px-3 py-1 border border-border-moderate rounded-md text-sm focus:ring-2 focus:ring-brand-cyan focus:outline-none",placeholder:"Threshold %"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:b.portfolioChange.enabled,onChange:o=>T(l=>({...l,portfolioChange:{...l.portfolioChange,enabled:o.target.checked}})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Portfolio change alerts"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:b.strategyStop.enabled,onChange:o=>T(l=>({...l,strategyStop:{...l.strategyStop,enabled:o.target.checked}})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Strategy alerts"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:b.connectionIssues.enabled,onChange:o=>T(l=>({...l,connectionIssues:{...l.connectionIssues,enabled:o.target.checked}})),className:"rounded"}),e.jsx("span",{className:"text-sm",children:"Connection alerts"})]})})]})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:u.length>0?u.map(o=>e.jsx("div",{className:`p-3 rounded-md border transition-all duration-200 cursor-pointer ${R(o)}`,onClick:()=>{a&&a(o),o.acknowledged||y(o.id)},children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[M(o),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-text-primary truncate",children:o.title}),e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold ${z(o.priority)}`,children:o.priority})]}),e.jsx("p",{className:"text-sm text-text-secondary mt-1",children:o.message}),e.jsx("p",{className:"text-xs text-text-muted mt-1",children:new Date(o.timestamp).toLocaleTimeString()})]})]}),e.jsx("button",{onClick:l=>{l.stopPropagation(),x(o.id)},className:"ml-2 p-1 text-text-muted hover:text-text-secondary transition-colors",children:e.jsx(se,{className:"h-4 w-4"})})]})},o.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{className:"h-12 w-12 text-text-muted mx-auto mb-4"}),e.jsx("p",{className:"text-text-secondary",children:"No alerts yet"}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"Real-time alerts will appear here"})]})})]})},Ve=({refreshInterval:f=5e3})=>{const{accountBalance:t,activeStrategies:a}=G(),{isConnected:r,on:n,off:c}=H(),[i,u]=d.useState(null),[m,p]=d.useState(!0),[C,F]=d.useState(Date.now()),L=d.useCallback(()=>{if(t){const g=parseFloat(t.total?.toString()||"0"),y=0,x=0,A=parseFloat(t.available?.toString()||"0"),j={change:0,changePercent:0,timestamp:Date.now()};u({totalValue:{value:g,...j},availableBalance:{value:A,...j},unrealizedPnL:{value:y,change:y,changePercent:g>0?y/g*100:0,timestamp:Date.now()},realizedPnL:{value:0,...j},dayPnL:{value:x,change:x,changePercent:0,timestamp:Date.now()},openPositions:0,marginUsed:0,marginFree:A,totalEquity:g}),p(!1)}},[t]),b=d.useCallback((...g)=>{const y=g[0];u(x=>{if(!x)return null;const A=(y.amount||0)*(y.price||0),j=y.profit||0,M=j>=0;return{...x,totalValue:{...x.totalValue,value:x.totalValue.value+j,change:j,changePercent:x.totalValue.value>0?j/x.totalValue.value*100:0,timestamp:Date.now()},realizedPnL:{...x.realizedPnL,value:x.realizedPnL.value+j,change:j,changePercent:M?Math.abs(j/A*100):-Math.abs(j/A*100),timestamp:Date.now()},dayPnL:{...x.dayPnL,value:x.dayPnL.value+j,change:j,changePercent:x.totalValue.value>0?(x.dayPnL.value+j)/x.totalValue.value*100:0,timestamp:Date.now()},openPositions:y.side==="buy"?x.openPositions+1:Math.max(0,x.openPositions-1)}}),F(Date.now())},[]),T=d.useCallback((...g)=>{const y=g[0];u(x=>{if(!x)return null;const A=y.changePercent||0,j=x.totalValue.value*(A/100)*.1;return{...x,unrealizedPnL:{...x.unrealizedPnL,value:x.unrealizedPnL.value+j,change:j,changePercent:x.totalValue.value>0?j/x.totalValue.value*100:0,timestamp:Date.now()},totalValue:{...x.totalValue,value:x.totalValue.value+j,change:j,changePercent:A*.1,timestamp:Date.now()}}})},[]);if(d.useEffect(()=>{L()},[L]),d.useEffect(()=>{if(r)return n("tradeExecuted",b),n("marketData",T),()=>{c("tradeExecuted",b),c("marketData",T)}},[r,b,T,n,c]),d.useEffect(()=>{const g=setInterval(()=>{F(Date.now())},f);return()=>clearInterval(g)},[f]),m||!i)return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((g,y)=>e.jsx("div",{className:"trading-card animate-pulse",children:e.jsx("div",{className:"h-20 bg-neutral-200 rounded"})},y))});const w=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(g),S=g=>`${g>=0?"+":""}${g.toFixed(2)}%`,k=g=>g>=0?"text-green-600":"text-red-600",v=g=>g>=0?"bg-green-100":"bg-red-100",D=g=>g>=0?e.jsx(me,{className:"h-5 w-5 text-green-600"}):e.jsx(ue,{className:"h-5 w-5 text-red-600"});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-neutral-500",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{children:r?"Live updates active":"Offline mode"})]}),e.jsxs("span",{children:["Last update: ",new Date(C).toLocaleTimeString()]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"trading-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-500 mb-1",children:"Total Portfolio"}),e.jsx("div",{className:"text-2xl font-bold text-neutral-800",children:w(i.totalValue.value)}),e.jsx("div",{className:`text-sm font-medium ${k(i.totalValue.changePercent)}`,children:S(i.totalValue.changePercent)})]}),e.jsx("div",{className:`p-2 rounded-full ${v(i.totalValue.changePercent)}`,children:e.jsx(oe,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx("div",{className:"trading-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-500 mb-1",children:"Today's P&L"}),e.jsx("div",{className:"text-2xl font-bold text-neutral-800",children:w(i.dayPnL.value)}),e.jsx("div",{className:`text-sm font-medium ${k(i.dayPnL.changePercent)}`,children:S(i.dayPnL.changePercent)})]}),e.jsx("div",{className:`p-2 rounded-full ${v(i.dayPnL.changePercent)}`,children:D(i.dayPnL.changePercent)})]})}),e.jsx("div",{className:"trading-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-500 mb-1",children:"Unrealized P&L"}),e.jsx("div",{className:"text-2xl font-bold text-neutral-800",children:w(i.unrealizedPnL.value)}),e.jsx("div",{className:`text-sm font-medium ${k(i.unrealizedPnL.changePercent)}`,children:S(i.unrealizedPnL.changePercent)})]}),e.jsx("div",{className:`p-2 rounded-full ${v(i.unrealizedPnL.changePercent)}`,children:e.jsx(ce,{className:"h-6 w-6 text-purple-600"})})]})}),e.jsx("div",{className:"trading-card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-500 mb-1",children:"Open Positions"}),e.jsx("div",{className:"text-2xl font-bold text-neutral-800",children:i.openPositions}),e.jsxs("div",{className:"text-sm text-neutral-500",children:[a.length," strategies active"]})]}),e.jsx("div",{className:"p-2 rounded-full bg-orange-100",children:e.jsx(de,{className:"h-6 w-6 text-orange-600"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"trading-card",children:[e.jsx("h4",{className:"text-lg font-medium text-neutral-800 mb-3",children:"Available Balance"}),e.jsx("div",{className:"text-xl font-bold text-neutral-800",children:w(i.availableBalance.value)}),e.jsx("div",{className:"text-sm text-neutral-500 mt-1",children:"Ready for trading"})]}),e.jsxs("div",{className:"trading-card",children:[e.jsx("h4",{className:"text-lg font-medium text-neutral-800 mb-3",children:"Realized P&L"}),e.jsx("div",{className:`text-xl font-bold ${k(i.realizedPnL.value)}`,children:w(i.realizedPnL.value)}),e.jsx("div",{className:"text-sm text-neutral-500 mt-1",children:"Closed positions"})]}),e.jsxs("div",{className:"trading-card",children:[e.jsx("h4",{className:"text-lg font-medium text-neutral-800 mb-3",children:"Total Equity"}),e.jsx("div",{className:"text-xl font-bold text-neutral-800",children:w(i.totalEquity)}),e.jsx("div",{className:"text-sm text-neutral-500 mt-1",children:"Including unrealized"})]})]})]})};be.register(ve,je,ye,Ne,we,ke,Se);const Je=()=>{const{strategies:f,trades:t}=G(),{isConnected:a,on:r,off:n}=H(),[c,i]=d.useState([]),[u,m]=d.useState("BTC-USDT"),[p,C]=d.useState(!1),F=["BTC-USDT","ETH-USDT","SOL-USDT","XRP-USDT","ADA-USDT","DOGE-USDT","MATIC-USDT","DOT-USDT"],L=d.useCallback(k=>{const v=k??{},D=(y,x=0)=>typeof y=="number"?y:typeof y=="string"&&parseFloat(y)||x;if((typeof v.pair=="string"?v.pair:"")===u){const y={timestamp:typeof v.timestamp=="number"?v.timestamp:Date.now(),value:D(v.close,D(v.price)),change:D(v.change),changePercent:D(v.changePercent)};i(x=>[...x,y].slice(-50))}},[u]),b=d.useCallback(k=>{},[]);d.useEffect(()=>{if(p&&a)return r("marketData",L),r("tradeExecuted",b),()=>{n("marketData",L),n("tradeExecuted",b)}},[p,a,L,b,r,n]);const T=()=>{C(!p),p||i([])},w=()=>({labels:c.map(v=>new Date(v.timestamp).toLocaleTimeString()),datasets:[{label:`${u} Price`,data:c.map(v=>v.value),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2,fill:!0,tension:.1}]}),S={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:`Real-time ${u} Price`}},scales:{y:{beginAtZero:!1}},animation:{duration:0}};return e.jsxs("div",{className:"container-responsive",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-neutral-800",children:"Real-time Trading Dashboard"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[a?e.jsx(xe,{className:"h-5 w-5 text-green-500"}):e.jsx(he,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{className:"text-sm text-neutral-600",children:a?"Connected":"Disconnected"})]}),e.jsx("select",{"aria-label":"Select trading pair",value:u,onChange:k=>m(k.target.value),className:"block w-32 px-3 py-2 border border-neutral-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:F.map(k=>e.jsx("option",{value:k,children:k},k))}),e.jsxs("button",{onClick:T,className:`flex items-center space-x-2 px-4 py-2 rounded-md font-medium transition-colors ${p?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:[e.jsx(ge,{size:16}),e.jsx("span",{children:p?"Stop Live":"Start Live"})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx(Ve,{})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"lg:col-span-2 trading-card",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Real-time Price Movement"}),e.jsx("div",{className:"h-64",children:c.length>0?e.jsx(pe,{data:w(),options:S}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx(fe,{className:"h-12 w-12 text-neutral-400 mx-auto mb-2"}),e.jsx("p",{className:"text-text-muted",children:p?"Waiting for real-time data...":"Start live mode to see real-time updates"})]})})})]}),e.jsx("div",{className:"trading-card",children:e.jsx(Ue,{maxAlerts:10})})]}),e.jsx("div",{className:"mb-6",children:e.jsx(Be,{})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"trading-card",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Live Strategy Performance"}),e.jsx(Fe,{strategies:f})]}),e.jsxs("div",{className:"trading-card",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Recent Live Trades"}),e.jsx(Ee,{trades:t})]})]})]})};export{Je as default};
//# sourceMappingURL=LiveTradingDashboard-C0K1vBGG.js.map
