import{r as C,j as e,a7 as $,a8 as B,a9 as Y,aa as Z,T as E,m as _,w as X,Z as ee,S as H,a0 as O,Q as te,v as se,A as ae,a1 as W,ab as ne,ac as Q}from"./vendor-DsQnMDHq.js";import{p as le,u as re}from"./index-CKZf6eLu.js";import{e as ie}from"./strategyExecutors-CW6YIKo8.js";import{C as ce,a as oe,b as de,P as me,c as xe,f as ue,p as he,d as ge,e as pe,i as be}from"./chartjs-DvSMsvNv.js";import"./crypto-CVBDpkJt.js";import"./utils-BDAWB_4D.js";import"./recharts-C046zHnu.js";import"./ui-D6B6e0vX.js";var fe=Object.defineProperty,je=(M,t,n)=>t in M?fe(M,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):M[t]=n,q=(M,t,n)=>je(M,typeof t!="symbol"?t+"":t,n);const z=class I{constructor(){q(this,"historicalDataCache",new Map)}static getInstance(){return I.instance||(I.instance=new I),I.instance}async runAdvancedBacktest(t,n){const a=await this.getMultiTimeframeData({symbols:[t.parameters.pair],timeframes:["1h","4h","1d"],startDate:n.startDate,endDate:n.endDate,includeVolume:!0,adjustForSplits:!0,adjustForDividends:!0}),s=a["1h"]||a["4h"]||a["1d"];if(!s||s.length===0)throw new Error("No historical data available");let l=n.initialBalance;const i=[];let c=l;const d=[];for(let p=50;p<s.length;p++){const N=s.slice(0,p+1),w=ie(t,N);if(w.signal){const S=s[p];if(!S)continue;const k=S.close,A=this.calculateOptimalPositionSize(l,k,N),P=this.executeAdvancedTrade(w.signal,k,A,l,n,N[N.length-1]);i.push(P),l=P.balance,l>c&&(c=l);const T=(c-l)/c;d.push({timestamp:S.timestamp,balance:l,drawdown:T})}}const j=this.calculateBasicMetrics(i,n.initialBalance),m=this.calculateAdvancedMetrics(i,d,n.initialBalance);return{...{strategyId:t.id,startDate:n.startDate,endDate:n.endDate,initialBalance:n.initialBalance,finalBalance:l,totalPnL:l-n.initialBalance,totalTrades:i.length,winningTrades:i.filter(p=>p.pnl>0).length,losingTrades:i.filter(p=>p.pnl<0).length,winRate:i.length>0?i.filter(p=>p.pnl>0).length/i.length*100:0,maxDrawdown:this.calculateMaxDrawdown(i),sharpeRatio:this.calculateSharpeRatio(i),trades:i,metrics:j},advancedMetrics:m}}async runPortfolioBacktest(t){const n=[],a=[];for(const c of t.strategies){const d=await this.runAdvancedBacktest(c,t);n.push(d)}const s=this.calculateStrategyCorrelations(n),l=this.calculatePortfolioReturns(n,t.weights),i=this.calculateDiversificationRatio(n,t.weights,s);return{portfolioBalance:l.reduce((c,d)=>c+d,t.initialBalance),strategyReturns:n,correlationMatrix:s,diversificationRatio:i,portfolioSharpe:this.calculatePortfolioSharpe(l),portfolioVolatility:this.calculatePortfolioVolatility(l),maxPortfolioDrawdown:this.calculatePortfolioMaxDrawdown(l),rebalanceEvents:a}}async runStressTest(t,n,a){const s={};for(const l of a)try{const i=await this.runStressScenario(t,n,l);s[l.name]=i}catch{}return s}async getMultiTimeframeData(t){const n=JSON.stringify(t);if(this.historicalDataCache.has(n))return this.historicalDataCache.get(n);const a={};for(const s of t.timeframes)for(const l of t.symbols)try{const i=await le.getHistoricalData(l,t.startDate,t.endDate);a[s]||(a[s]=[]),a[s]=i}catch{}return this.historicalDataCache.set(n,a),a}calculateOptimalPositionSize(t,n,a){const s=a.slice(-20),l=[];for(let m=1;m<s.length;m++){const h=s[m-1],p=s[m];if(!h||!p)continue;const N=h.close||0,w=N!==0?(p.close-h.close)/N:0;l.push(w)}const i=Math.sqrt(l.reduce((m,h)=>m+h*h,0)/l.length),c=.02,d=Math.max(.1,Math.min(2,1/(i*100))),j=c*d;return t*j/n}executeAdvancedTrade(t,n,a,s,l,i){const c=Math.min(.001,a/(i.volume||1e6)*.01),d=Math.abs(i.high-i.low)/i.close*.1,j=l.slippage+c+d,m=t==="BUY"?n*(1+j):n*(1-j),h=m*a,p=h*l.feeRate,N=t==="SELL"?h-p-n*a:0,w=N/(n*a)*100,S=t==="BUY"?s-h-p:s+h-p;return{id:`trade-${i.timestamp}-${t}`,entryPrice:m,exitPrice:t==="SELL"?m:null,entryTime:new Date(i.timestamp).toISOString(),exitTime:t==="SELL"?new Date(i.timestamp).toISOString():null,side:t==="BUY"?"long":"short",status:t==="SELL"?"closed":"open",pnl:N,pnlPercent:w,balance:S,size:a,fee:p,timestamp:i.timestamp,type:t,price:m,amount:a,total:h}}calculateAdvancedMetrics(t,n,a){const s=t.map(u=>u.pnlPercent/100),l=this.calculateDailyReturns(t),i=this.calculateMonthlyReturns(t),c=[...s].sort((u,y)=>u-y),d=s.filter(u=>u<0),j=s.filter(u=>u>0),m=s.reduce((u,y)=>u+y,0)/s.length,h=s.reduce((u,y)=>u+Math.pow(y-m,2),0)/s.length,p=Math.sqrt(h),N=this.calculateSkewness(s,m,p),w=this.calculateKurtosis(s,m,p),S=Math.floor(.05*c.length),k=Math.floor(.01*c.length),A=c[S]||0,P=c[k]||0,T=c.slice(0,S+1).reduce((u,y)=>u+y,0)/(S+1)||0,o=c.slice(0,k+1).reduce((u,y)=>u+y,0)/(k+1)||0,g=s.filter(u=>u<0),r=Math.sqrt(g.reduce((u,y)=>u+y*y,0)/g.length),v=r>0?m/r:0,x=Math.max(...n.map(u=>u.drawdown)),f=x>0?m*252/x:0,D=Math.sqrt(n.reduce((u,y)=>u+y.drawdown*y.drawdown,0)/n.length),b=D>0?m/D:0,R=0,L=s.filter(u=>u>R).reduce((u,y)=>u+(y-R),0),V=Math.abs(s.filter(u=>u<R).reduce((u,y)=>u+(y-R),0)),F=V>0?L/V:0;return{dailyReturns:l,monthlyReturns:i,volatility:p,profitFactor:this.calculateProfitFactor(t),recoveryFactor:(()=>{if(x<=0)return 0;const u=t.length>0?t[t.length-1]:void 0;return((u?u.balance:a)-a)/(x*a)})(),averageWin:j.reduce((u,y)=>u+y,0)/j.length||0,averageLoss:Math.abs(d.reduce((u,y)=>u+y,0)/d.length)||0,largestWin:Math.max(...s),largestLoss:Math.min(...s),averageHoldingPeriod:this.calculateAverageHoldingPeriod(t),bestMonth:Math.max(...i),worstMonth:Math.min(...i),valueAtRisk95:Math.abs(A)*100,valueAtRisk99:Math.abs(P)*100,conditionalVaR95:Math.abs(T)*100,conditionalVaR99:Math.abs(o)*100,calmarRatio:f,sortinoRatio:v,omegaRatio:F,kappa3:r>0?m/Math.pow(r,3):0,gainToPainRatio:this.calculateGainToPainRatio(s),ulcerIndex:D,martinRatio:b,painIndex:this.calculatePainIndex(n),burkeRatio:this.calculateBurkeRatio(s,n),modifiedSharpe:this.calculateModifiedSharpe(s,N,w),treynorRatio:0,informationRatio:0,modigliani:0,excessReturnOnVaR:A!==0?m/Math.abs(A):0,conditionalSharpe:T!==0?m/Math.abs(T):0,skewness:N,kurtosis:w,tailRatio:P!==0?Math.abs(A/P):0,upnessIndex:this.calculateUpnessIndex(s),upsidePotentialRatio:this.calculateUpsidePotentialRatio(s)}}calculateSkewness(t,n,a){if(a===0)return 0;const s=t.length;return s/((s-1)*(s-2))*t.reduce((l,i)=>l+Math.pow((i-n)/a,3),0)}calculateKurtosis(t,n,a){if(a===0)return 0;const s=t.length,l=s*(s+1)/((s-1)*(s-2)*(s-3)),i=3*(s-1)*(s-1)/((s-2)*(s-3));return l*t.reduce((c,d)=>c+Math.pow((d-n)/a,4),0)-i}calculateGainToPainRatio(t){const n=t.filter(s=>s>0).reduce((s,l)=>s+l,0),a=Math.abs(t.filter(s=>s<0).reduce((s,l)=>s+l,0));return a>0?n/a:0}calculatePainIndex(t){return t.reduce((n,a)=>n+a.drawdown,0)/t.length}calculateBurkeRatio(t,n){const a=t.reduce((l,i)=>l+i,0)/t.length*252,s=Math.sqrt(n.reduce((l,i)=>l+i.drawdown*i.drawdown,0));return s>0?a/s:0}calculateModifiedSharpe(t,n,a){const s=t.reduce((d,j)=>d+j,0)/t.length,l=Math.sqrt(t.reduce((d,j)=>d+Math.pow(j-s,2),0)/t.length);if(l===0)return 0;const i=s/l,c=1+n/6*i-(a-3)/24*i*i;return i*c}calculateUpnessIndex(t){return t.filter(a=>a>0).length/t.length}calculateUpsidePotentialRatio(t){const a=t.filter(l=>l>0).reduce((l,i)=>l+(i-0),0)/t.length,s=Math.sqrt(t.filter(l=>l<0).reduce((l,i)=>l+Math.pow(i-0,2),0)/t.length);return s>0?a/s:0}calculateBasicMetrics(t,n){const a=this.calculateDailyReturns(t),s=this.calculateMonthlyReturns(t),l=t.filter(c=>c.pnl>0),i=t.filter(c=>c.pnl<0);return{dailyReturns:a,monthlyReturns:s,volatility:this.calculateVolatility(a),profitFactor:this.calculateProfitFactor(t),recoveryFactor:(()=>{const c=this.calculateMaxDrawdown(t);if(c<=0)return 0;const d=t.length>0?t[t.length-1]:void 0;return((d?d.balance:n)-n)/(c*n)})(),averageWin:l.reduce((c,d)=>c+d.pnl,0)/l.length||0,averageLoss:Math.abs(i.reduce((c,d)=>c+d.pnl,0)/i.length)||0,largestWin:t.length>0?Math.max(...t.map(c=>c.pnl)):0,largestLoss:t.length>0?Math.min(...t.map(c=>c.pnl)):0,averageHoldingPeriod:this.calculateAverageHoldingPeriod(t),bestMonth:s.length>0?Math.max(...s):0,worstMonth:s.length>0?Math.min(...s):0}}calculateVolatility(t){if(t.length<2)return 0;const n=t.reduce((a,s)=>a+s,0)/t.length;return Math.sqrt(t.reduce((a,s)=>a+Math.pow(s-n,2),0)/t.length)}calculateDailyReturns(t){const n=new Map;return t.forEach(a=>{if(a.timestamp){const s=new Date(a.timestamp).toISOString().split("T")[0]??"",l=n.get(s)??0;n.set(s,l+(a.pnl??0))}}),Array.from(n.values())}calculateMonthlyReturns(t){const n=new Map;return t.forEach(a=>{if(a.timestamp){const s=new Date(a.timestamp),l=`${s.getFullYear()}-${s.getMonth()+1}`,i=n.get(l)??0;n.set(l,i+(a.pnl??0))}}),Array.from(n.values())}calculateMaxDrawdown(t){let n=-1/0,a=0;return t.forEach(s=>{s.balance>n&&(n=s.balance);const l=(n-s.balance)/n;a=Math.max(a,l)}),a}calculateSharpeRatio(t){const n=t.map(l=>l.pnlPercent),a=n.reduce((l,i)=>l+i,0)/n.length,s=Math.sqrt(n.reduce((l,i)=>l+Math.pow(i-a,2),0)/n.length);return a/s}calculateProfitFactor(t){const n=t.filter(s=>s.pnl>0).reduce((s,l)=>s+l.pnl,0),a=Math.abs(t.filter(s=>s.pnl<0).reduce((s,l)=>s+l.pnl,0));return n/a}calculateAverageHoldingPeriod(t){let n=0,a=0;for(let s=0;s<t.length-1;s++){const l=t[s],i=t[s+1];!l||!i||l.type==="BUY"&&i.type==="SELL"&&i.timestamp&&l.timestamp&&(n+=(i.timestamp??0)-(l.timestamp??0),a++)}return n/a/(1e3*60*60)}calculateStrategyCorrelations(t){const n=t.length,a=Array(n).fill(null).map(()=>Array(n).fill(0));for(let s=0;s<n;s++)for(let l=0;l<n;l++)if(s===l)(a[s]??(a[s]=[]))[l]=1;else{const i=t[s],c=t[l],d=i?.trades?.map(m=>m.pnlPercent)??[],j=c?.trades?.map(m=>m.pnlPercent)??[];(a[s]??(a[s]=[]))[l]=this.calculateCorrelation(d,j)}return a}calculateCorrelation(t,n){const a=Math.min(t.length,n.length);if(a===0)return 0;const s=t.slice(0,a).reduce((m,h)=>m+h,0)/a,l=n.slice(0,a).reduce((m,h)=>m+h,0)/a;let i=0,c=0,d=0;for(let m=0;m<a;m++){const h=t.at(m),p=n.at(m);if(h===void 0||p===void 0)continue;const N=h-s,w=p-l;i+=N*w,c+=N*N,d+=w*w}const j=Math.sqrt(c*d);return j===0?0:i/j}calculatePortfolioReturns(t,n){const a=Math.max(...t.map(l=>l.trades.length)),s=[];for(let l=0;l<a;l++){let i=0;for(let c=0;c<t.length;c++){const j=t[c]?.trades?.[l],m=n[c]??0;j&&(i+=j.pnlPercent/100*m)}s.push(i)}return s}calculateDiversificationRatio(t,n,a){const s=n.reduce((c,d,j)=>{const h=t[j]?.trades??[];if(h.length===0)return c;const p=Math.sqrt(h.reduce((N,w)=>N+w.pnlPercent*w.pnlPercent,0)/h.length);return c+d*p},0);let l=0;for(let c=0;c<n.length;c++)for(let d=0;d<n.length;d++){const j=t[c],m=t[d],h=j?.trades??[],p=m?.trades??[];if(h.length===0||p.length===0)continue;const N=Math.sqrt(h.reduce((T,o)=>T+o.pnlPercent*o.pnlPercent,0)/h.length),w=Math.sqrt(p.reduce((T,o)=>T+o.pnlPercent*o.pnlPercent,0)/p.length),k=(a[c]??[])[d]??0,A=n[c]??0,P=n[d]??0;l+=A*P*k*N*w}const i=Math.sqrt(l);return i>0?s/i:0}calculatePortfolioSharpe(t){const n=t.reduce((s,l)=>s+l,0)/t.length,a=Math.sqrt(t.reduce((s,l)=>s+(l-n)*(l-n),0)/t.length);return a>0?n/a:0}calculatePortfolioVolatility(t){const n=t.reduce((a,s)=>a+s,0)/t.length;return Math.sqrt(t.reduce((a,s)=>a+(s-n)*(s-n),0)/t.length)}calculatePortfolioMaxDrawdown(t){let n=-1/0,a=0,s=0;for(const l of t){s+=l,s>n&&(n=s);const i=(n-s)/Math.abs(n);a=Math.max(a,i)}return a}async runStressScenario(t,n,a){return this.runAdvancedBacktest(t,n)}};q(z,"instance");let ye=z;const ve=ye.getInstance(),Ne=({onDataLoaded:M})=>{const[t,n]=C.useState({symbols:["BTC_USDT"],timeframes:["1h"],startDate:"2023-01-01",endDate:"2024-01-01",includeVolume:!0,adjustForSplits:!0,adjustForDividends:!1}),[a,s]=C.useState([]),[l,i]=C.useState(!1),[c,d]=C.useState(0),[j,m]=C.useState(null),h=["BTC_USDT","ETH_USDT","BNB_USDT","ADA_USDT","XRP_USDT","SOL_USDT","DOT_USDT","DOGE_USDT","AVAX_USDT","SHIB_USDT"],p=[{value:"1m",label:"1 Minute"},{value:"5m",label:"5 Minutes"},{value:"15m",label:"15 Minutes"},{value:"30m",label:"30 Minutes"},{value:"1h",label:"1 Hour"},{value:"4h",label:"4 Hours"},{value:"1d",label:"1 Day"},{value:"1w",label:"1 Week"}],N=o=>{t.symbols.includes(o)||n(g=>({...g,symbols:[...g.symbols,o]}))},w=o=>{n(g=>({...g,symbols:g.symbols.filter(r=>r!==o)}))},S=o=>{n(g=>({...g,timeframes:g.timeframes.includes(o)?g.timeframes.filter(r=>r!==o):[...g.timeframes,o]}))},k=async()=>{i(!0),m(null),d(0);try{const o=t.symbols.length*t.timeframes.length;let g=0;const r=[],v=[];for(const x of t.symbols)for(const f of t.timeframes){await new Promise(F=>setTimeout(F,500));const D=Math.floor(Math.random()*1e3)+500,b=Math.floor(Math.random()*50),R=(D-b)/D*100;r.push({symbol:x,timeframe:f,totalCandles:D,missingCandles:b,completeness:R,gaps:b>0?[{start:"2023-06-15T10:00:00Z",end:"2023-06-15T12:00:00Z",duration:7200*1e3}]:[]});const L=[],V=5e4;for(let F=0;F<D;F++){const u=Date.now()-(D-F)*6e4,y=V+(Math.random()-.5)*1e3,U=y+(Math.random()-.5)*100,G=Math.max(y,U)+Math.random()*50,J=Math.min(y,U)-Math.random()*50,K=Math.random()*1e6;L.push({timestamp:u,open:y,high:G,low:J,close:U,volume:K})}v.push({symbol:x,timeframe:f,data:L}),g++,d(g/o*100)}s(r),M&&M(v)}catch(o){m(o instanceof Error?o.message:"Failed to load historical data")}finally{i(!1),d(0)}},A=()=>{const o=JSON.stringify(t,null,2),g="data:application/json;charset=utf-8,"+encodeURIComponent(o),r=`data-request-${new Date().toISOString().split("T")[0]}.json`,v=document.createElement("a");v.setAttribute("href",g),v.setAttribute("download",r),v.click()},P=o=>o>=95?"text-green-600":o>=85?"text-yellow-600":"text-red-600",T=o=>o>=95?e.jsx(X,{className:"w-4 h-4 text-green-600"}):o>=85?e.jsx(_,{className:"w-4 h-4 text-yellow-600"}):e.jsx(_,{className:"w-4 h-4 text-red-600"});return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),"Historical Data Manager"]}),e.jsxs("button",{onClick:A,className:"flex items-center px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"Export Config"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-medium mb-3",children:"Trading Pairs"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 mb-3",children:h.map(o=>e.jsx("button",{onClick:()=>t.symbols.includes(o)?w(o):N(o),className:`px-3 py-2 text-sm rounded-md border transition-colors ${t.symbols.includes(o)?"bg-blue-50 border-blue-500 text-blue-700":"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100"}`,children:o},o))}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Selected: ",t.symbols.length," pairs"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-medium mb-3",children:"Timeframes"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mb-3",children:p.map(({value:o,label:g})=>e.jsx("button",{onClick:()=>S(o),className:`px-3 py-2 text-sm rounded-md border transition-colors ${t.timeframes.includes(o)?"bg-blue-50 border-blue-500 text-blue-700":"bg-gray-50 border-gray-300 text-gray-700 hover:bg-gray-100"}`,children:g},o))}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Selected: ",t.timeframes.length," timeframes"]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Date Range"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:t.startDate,onChange:o=>n(g=>({...g,startDate:o.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:t.endDate,onChange:o=>n(g=>({...g,endDate:o.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Data Options"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.includeVolume,onChange:o=>n(g=>({...g,includeVolume:o.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Include Volume Data"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.adjustForSplits,onChange:o=>n(g=>({...g,adjustForSplits:o.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Adjust for Stock Splits"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.adjustForDividends,onChange:o=>n(g=>({...g,adjustForDividends:o.target.checked})),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Adjust for Dividends"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("button",{onClick:k,disabled:l||t.symbols.length===0||t.timeframes.length===0,className:"w-full px-4 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Loading... ",c.toFixed(0),"%"]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Load Historical Data"]})}),l&&e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${c}%`}})})})]}),j&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"w-4 h-4 text-red-600 mr-2"}),e.jsx("span",{className:"text-sm text-red-700",children:j})]})}),a.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-3",children:"Data Quality Report"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Symbol"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timeframe"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Candles"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Missing"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Completeness"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map((o,g)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:o.symbol}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:o.timeframe}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:o.totalCandles.toLocaleString()}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:o.missingCandles}),e.jsxs("td",{className:`px-4 py-3 whitespace-nowrap text-sm font-medium ${P(o.completeness)}`,children:[o.completeness.toFixed(1),"%"]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:e.jsxs("div",{className:"flex items-center",children:[T(o.completeness),e.jsx("span",{className:`ml-2 ${P(o.completeness)}`,children:o.completeness>=95?"Excellent":o.completeness>=85?"Good":"Poor"})]})})]},g))})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Datasets"}),e.jsx("p",{className:"text-lg font-bold",children:a.length})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Average Completeness"}),e.jsxs("p",{className:"text-lg font-bold",children:[a.length>0?(a.reduce((o,g)=>o+g.completeness,0)/a.length).toFixed(1):0,"%"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Candles"}),e.jsx("p",{className:"text-lg font-bold",children:a.reduce((o,g)=>o+g.totalCandles,0).toLocaleString()})]})]})]})]})};ce.register(oe,de,me,xe,ue,he,ge,pe,be);const Ce=()=>{const{strategies:M}=re(),[t,n]=C.useState(null),[a,s]=C.useState({startDate:"2023-01-01",endDate:"2024-01-01",initialBalance:1e4,feeRate:.001,slippage:.001,useHistoricalData:!0}),[l,i]=C.useState([]),[c,d]=C.useState(null),[j,m]=C.useState(!1),[h,p]=C.useState("setup"),[N,w]=C.useState(!1);C.useEffect(()=>{if(M.length>0&&l.length===0){const r=M[0];if(!r)return;i([{id:"1",name:"Sample Backtest",strategy:r,options:a,result:null,advancedMetrics:{valueAtRisk95:0,valueAtRisk99:0,conditionalVaR95:0,conditionalVaR99:0,calmarRatio:0,sortinoRatio:0,omegaRatio:0,tailRatio:0,gainToLossRatio:0,payoffRatio:0,expectancy:0,systemQualityNumber:0,kRatio:0,ulcerIndex:0,recoveryFactor:0,profitabilityIndex:0,painIndex:0,martinRatio:0,burkeRatio:0,skewness:0,kurtosis:0,upnessIndex:0,upsidePotentialRatio:0,gainToPainRatio:0},createdAt:new Date,status:"pending"}])}},[M,a,l.length]);const S=async()=>{if(!t)return;m(!0);const r=Date.now().toString(),v={id:r,name:`Backtest ${t.name} ${new Date().toLocaleDateString()}`,strategy:t,options:a,result:null,advancedMetrics:{valueAtRisk95:0,valueAtRisk99:0,conditionalVaR95:0,conditionalVaR99:0,calmarRatio:0,sortinoRatio:0,omegaRatio:0,tailRatio:0,gainToLossRatio:0,payoffRatio:0,expectancy:0,systemQualityNumber:0,kRatio:0,ulcerIndex:0,recoveryFactor:0,profitabilityIndex:0,painIndex:0,martinRatio:0,burkeRatio:0,skewness:0,kurtosis:0,upnessIndex:0,upsidePotentialRatio:0,gainToPainRatio:0},createdAt:new Date,status:"running"};i(x=>[v,...x]),d(v);try{const x=await ve.runAdvancedBacktest(t,a),f=x.advancedMetrics,D={...v,result:{...x,metrics:{...x.metrics,netProfit:x.totalPnL,grossProfit:x.trades.filter(b=>b.pnl>0).reduce((b,R)=>b+R.pnl,0),grossLoss:Math.abs(x.trades.filter(b=>b.pnl<0).reduce((b,R)=>b+R.pnl,0)),maxConsecutiveWins:0,maxConsecutiveLosses:0,averageTrade:x.trades.reduce((b,R)=>b+R.pnl,0)/x.trades.length||0,averageProfit:x.trades.filter(b=>b.pnl>0).reduce((b,R)=>b+R.pnl,0)/x.trades.filter(b=>b.pnl>0).length||0,averageLoss:x.trades.filter(b=>b.pnl<0).reduce((b,R)=>b+R.pnl,0)/x.trades.filter(b=>b.pnl<0).length||0,largestProfit:Math.max(...x.trades.map(b=>b.pnl)),largestLoss:Math.min(...x.trades.map(b=>b.pnl)),annualizedReturn:(x.finalBalance/x.initialBalance-1)*365/365}},advancedMetrics:{valueAtRisk95:f.valueAtRisk95||0,valueAtRisk99:f.valueAtRisk99||0,conditionalVaR95:f.conditionalVaR95||0,conditionalVaR99:f.conditionalVaR99||0,calmarRatio:f.calmarRatio||0,sortinoRatio:f.sortinoRatio||0,omegaRatio:f.omegaRatio||0,tailRatio:f.tailRatio||0,gainToLossRatio:(f.averageWin||0)/Math.max(Math.abs(f.averageLoss||0),1),payoffRatio:(f.averageWin||0)/Math.max(Math.abs(f.averageLoss||0),1),expectancy:(f.averageWin||0)*(x.winRate/100)-Math.abs(f.averageLoss||0)*((100-x.winRate)/100),systemQualityNumber:x.sharpeRatio*Math.sqrt(x.totalTrades),kRatio:0,ulcerIndex:f.ulcerIndex||0,recoveryFactor:f.recoveryFactor||0,profitabilityIndex:(x.finalBalance-x.initialBalance)/x.initialBalance||0,painIndex:f.painIndex||0,martinRatio:f.martinRatio||0,burkeRatio:f.burkeRatio||0,skewness:f.skewness||0,kurtosis:f.kurtosis||0,upnessIndex:f.upnessIndex||0,upsidePotentialRatio:f.upsidePotentialRatio||0,gainToPainRatio:f.gainToPainRatio||0},status:"completed"};i(b=>b.map(R=>R.id===r?D:R)),d(D),p("results")}catch{const f={...v,status:"failed"};i(D=>D.map(b=>b.id===r?f:b))}finally{m(!1)}},k=async r=>{c?.result},A=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-bg-tertiary p-6 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-medium mb-4 flex items-center",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Backtest Configuration"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Strategy"}),e.jsxs("select",{value:t?.id||"",onChange:r=>{const v=M.find(x=>x.id===r.target.value);n(v||null)},className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select a strategy"}),M.map(r=>e.jsxs("option",{value:r.id,children:[r.name," (",r.type,")"]},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Initial Balance (USD)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"number",min:"100",max:"1000000",step:"100",value:a.initialBalance,onChange:r=>s({...a,initialBalance:parseFloat(r.target.value)||1e4}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter amount (min: $100)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[1e3,5e3,1e4,25e3,5e4,1e5].map(r=>e.jsxs("button",{type:"button",onClick:()=>s({...a,initialBalance:r}),className:`px-3 py-1 text-xs rounded-md border transition-colors ${a.initialBalance===r?"bg-blue-100 border-blue-300 text-blue-700":"bg-bg-secondary border-border-subtle text-gray-600 hover:bg-bg-tertiary"}`,children:["$",r.toLocaleString()]},r))}),e.jsx("p",{className:"text-xs text-text-muted",children:"Choose a starting balance for your backtest simulation"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:a.startDate,onChange:r=>s({...a,startDate:r.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:a.endDate,onChange:r=>s({...a,endDate:r.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fee Rate (%)"}),e.jsx("input",{type:"number",step:"0.001",value:a.feeRate*100,onChange:r=>s({...a,feeRate:parseFloat(r.target.value)/100}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slippage (%)"}),e.jsx("input",{type:"number",step:"0.001",value:a.slippage*100,onChange:r=>s({...a,slippage:parseFloat(r.target.value)/100}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsx("div",{className:"mt-6 flex justify-end space-x-3",children:e.jsxs("button",{onClick:S,disabled:!t||j,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),j?"Running Backtest...":"Run Backtest"]})})]}),e.jsxs("div",{className:"bg-bg-tertiary p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Recent Sessions"}),e.jsx("div",{className:"space-y-3",children:l.slice(0,5).map(r=>e.jsx("div",{onClick:()=>d(r),className:`p-4 border rounded-md cursor-pointer transition-colors ${c?.id===r.id?"border-blue-500 bg-blue-50":"border-border-subtle hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:r.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.strategy.name," • ",r.createdAt.toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r.status==="completed"?"bg-green-100 text-green-800":r.status==="running"?"bg-yellow-100 text-yellow-800":r.status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:r.status}),r.result&&e.jsxs("span",{className:`text-sm font-medium ${r.result.totalPnL>0?"text-green-600":"text-red-600"}`,children:[r.result.totalPnL>0?"+":"","$",r.result.totalPnL.toFixed(2)]})]})]})},r.id))})]})]}),P=()=>{if(!c?.result)return e.jsxs("div",{className:"bg-bg-tertiary p-8 rounded-lg shadow text-center",children:[e.jsx(E,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No Results Available"}),e.jsx("p",{className:"text-gray-600",children:"Run a backtest to see results here."})]});const r=c.result,v=c.advancedMetrics;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-bg-tertiary p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"w-8 h-8 text-green-500 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Return"}),e.jsxs("p",{className:`text-xl font-bold ${r.totalPnL>0?"text-green-600":"text-red-600"}`,children:[((r.finalBalance-r.initialBalance)/r.initialBalance*100).toFixed(2),"%"]})]})]})}),e.jsx("div",{className:"bg-bg-tertiary p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"w-8 h-8 text-blue-500 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sharpe Ratio"}),e.jsx("p",{className:"text-xl font-bold",children:r.sharpeRatio.toFixed(2)})]})]})}),e.jsx("div",{className:"bg-bg-tertiary p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"w-8 h-8 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Max Drawdown"}),e.jsxs("p",{className:"text-xl font-bold text-red-600",children:[r.maxDrawdown.toFixed(2),"%"]})]})]})}),e.jsx("div",{className:"bg-bg-tertiary p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"w-8 h-8 text-purple-500 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Win Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[r.winRate.toFixed(1),"%"]})]})]})})]}),v&&e.jsxs("div",{className:"bg-bg-tertiary p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Advanced Risk Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"VaR (95%)"}),e.jsxs("p",{className:"text-lg font-bold",children:[v.valueAtRisk95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"CVaR (95%)"}),e.jsxs("p",{className:"text-lg font-bold",children:[v.conditionalVaR95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Calmar Ratio"}),e.jsx("p",{className:"text-lg font-bold",children:v.calmarRatio.toFixed(2)})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sortino Ratio"}),e.jsx("p",{className:"text-lg font-bold",children:v.sortinoRatio.toFixed(2)})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Omega Ratio"}),e.jsx("p",{className:"text-lg font-bold",children:v.omegaRatio.toFixed(2)})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Expectancy"}),e.jsxs("p",{className:"text-lg font-bold",children:["$",v.expectancy.toFixed(2)]})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Ulcer Index"}),e.jsx("p",{className:"text-lg font-bold",children:v.ulcerIndex.toFixed(2)})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Recovery Factor"}),e.jsx("p",{className:"text-lg font-bold",children:v.recoveryFactor.toFixed(2)})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Equity Curve"}),e.jsx("div",{className:"h-64",children:e.jsx(W,{data:{labels:r.trades.map((x,f)=>f+1),datasets:[{label:"Equity",data:r.trades.map(x=>x.balance),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.1,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!1}}}})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Trade Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"P&L Distribution"}),e.jsx("div",{className:"h-48",children:e.jsx(ne,{data:{labels:["Winning Trades","Losing Trades"],datasets:[{label:"Count",data:[r.winningTrades,r.losingTrades],backgroundColor:["rgba(34, 197, 94, 0.8)","rgba(239, 68, 68, 0.8)"]}]},options:{responsive:!0,maintainAspectRatio:!1}})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Monthly Returns"}),e.jsx("div",{className:"h-48",children:e.jsx(W,{data:{labels:r.metrics.monthlyReturns.map((x,f)=>`Month ${f+1}`),datasets:[{label:"Monthly Return",data:r.metrics.monthlyReturns,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1}})})]})]})]})]})},T=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ne,{onDataLoaded:r=>{w(!0)}}),N&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-5 h-5 text-green-600 mr-2"}),e.jsx("span",{className:"text-sm text-green-700 font-medium",children:"Historical data successfully loaded and ready for backtesting"})]})})]}),o=()=>{if(!c?.advancedMetrics)return e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow text-center",children:[e.jsx(Q,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Advanced Analysis"}),e.jsx("p",{className:"text-gray-600",children:"Run a backtest to see advanced analysis and risk metrics."})]});const r=c.advancedMetrics;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Risk Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Value at Risk"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-red-600",children:"VaR (95%)"}),e.jsxs("span",{className:"font-bold text-red-800",children:[r.valueAtRisk95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-red-600",children:"VaR (99%)"}),e.jsxs("span",{className:"font-bold text-red-800",children:[r.valueAtRisk99.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-orange-800 mb-2",children:"Conditional VaR"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-orange-600",children:"CVaR (95%)"}),e.jsxs("span",{className:"font-bold text-orange-800",children:[r.conditionalVaR95.toFixed(2),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-orange-600",children:"CVaR (99%)"}),e.jsxs("span",{className:"font-bold text-orange-800",children:[r.conditionalVaR99.toFixed(2),"%"]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Advanced Ratios"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-brand-cyan",children:"Calmar Ratio"}),e.jsx("span",{className:"font-bold text-blue-800",children:r.calmarRatio.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-brand-cyan",children:"Sortino Ratio"}),e.jsx("span",{className:"font-bold text-blue-800",children:r.sortinoRatio.toFixed(2)})]})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Downside Risk Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Ulcer Index"}),e.jsx("p",{className:"text-lg font-bold",children:r.ulcerIndex.toFixed(2)})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pain Index"}),e.jsx("p",{className:"text-lg font-bold",children:r.painIndex.toFixed(2)})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Martin Ratio"}),e.jsx("p",{className:"text-lg font-bold",children:r.martinRatio.toFixed(2)})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Burke Ratio"}),e.jsx("p",{className:"text-lg font-bold",children:r.burkeRatio.toFixed(2)})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Return Distribution Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Statistical Measures"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Skewness"}),e.jsx("span",{className:"font-medium",children:r.skewness.toFixed(3)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Kurtosis"}),e.jsx("span",{className:"font-medium",children:r.kurtosis.toFixed(3)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Tail Ratio"}),e.jsx("span",{className:"font-medium",children:r.tailRatio.toFixed(3)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Upside Potential"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Upness Index"}),e.jsxs("span",{className:"font-medium",children:[(r.upnessIndex*100).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Upside Potential Ratio"}),e.jsx("span",{className:"font-medium",children:r.upsidePotentialRatio.toFixed(3)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Gain to Pain Ratio"}),e.jsx("span",{className:"font-medium",children:r.gainToPainRatio.toFixed(3)})]})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Performance Attribution"}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[e.jsx(Q,{className:"w-8 h-8 text-brand-cyan mx-auto mb-2"}),e.jsx("p",{className:"text-blue-700 font-medium",children:"Factor Analysis"}),e.jsx("p",{className:"text-sm text-brand-cyan mt-1",children:"Factor decomposition and performance attribution analysis coming in next update"})]})]})]})},g=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Export Results"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>k(),className:"flex items-center justify-center p-4 border border-gray-300 rounded-md hover:bg-gray-50",children:[e.jsx(B,{className:"w-5 h-5 mr-2"}),"Export CSV"]}),e.jsxs("button",{onClick:()=>k(),className:"flex items-center justify-center p-4 border border-gray-300 rounded-md hover:bg-gray-50",children:[e.jsx(B,{className:"w-5 h-5 mr-2"}),"Export Excel"]}),e.jsxs("button",{onClick:()=>k(),className:"flex items-center justify-center p-4 border border-gray-300 rounded-md hover:bg-gray-50",children:[e.jsx(B,{className:"w-5 h-5 mr-2"}),"Export PDF Report"]})]})]})});return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-text-primary flex items-center",children:[e.jsx(ee,{className:"w-8 h-8 mr-3 text-brand-cyan"}),"Advanced Backtesting Engine"]}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Comprehensive strategy testing with advanced risk metrics and performance analysis"})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-border-subtle",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"setup",label:"Setup",icon:H},{id:"data",label:"Historical Data",icon:$},{id:"results",label:"Results",icon:E},{id:"analysis",label:"Analysis",icon:O},{id:"reports",label:"Reports",icon:B}].map(({id:r,label:v,icon:x})=>e.jsxs("button",{onClick:()=>p(r),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center ${h===r?"border-blue-500 text-blue-600":"border-transparent text-text-muted hover:text-text-secondary hover:border-border-moderate"}`,children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),v]},r))})})}),h==="setup"&&A(),h==="data"&&T(),h==="results"&&P(),h==="analysis"&&o(),h==="reports"&&g()]})};export{Ce as default};
//# sourceMappingURL=Backtesting-CxVL2-vg.js.map
