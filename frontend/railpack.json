{
  "$schema": "https://schema.railpack.com",
  "provider": "node",
  "node": {
    "version": "22"
  },
  "env": {
    "NODE_ENV": "production"
  },
  "install": {
    "commands": [
      "corepack enable",
      "corepack prepare yarn@4.9.2 --activate",
      "yarn install --immutable"
    ]
  },
  "build": {
    "commands": [
      "rm -rf ./src/shared",
      "mkdir -p ./src/shared/types ./src/shared/middleware",
      "cp ../shared/types/*.ts ./src/shared/types/ 2>/dev/null || true",
      "cp ../shared/*.ts ./src/shared/ 2>/dev/null || true",
      "cp -r ../shared/middleware ./src/shared/ 2>/dev/null || true",
      "yarn build:railway"
    ]
  },
  "start": {
    "command": "node serve.js"
  },
  "health": {
    "path": "/healthz",
    "timeout": 300
  }
}
