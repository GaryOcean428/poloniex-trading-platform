{
  "version": "1",
  "build": {
    "provider": "nodejs",
    "nodejs": {
      "version": "22",
      "packageManager": "yarn"
    },
    "install": {
      "commands": [
        "corepack enable",
        "corepack prepare yarn@4.9.2 --activate",
        "yarn install --immutable"
      ]
    },
    "steps": {
      "copyShared": {
        "commands": [
          "rm -rf ./shared",
          "mkdir -p ./shared",
          "cp -r ../shared/* ./shared/ 2>/dev/null || echo 'Shared directory not found'"
        ],
        "dependsOn": ["install"]
      },
      "build": {
        "commands": ["yarn build"],
        "dependsOn": ["copyShared"]
      }
    }
  },
  "deploy": {
    "startCommand": "yarn start",
    "healthCheckPath": "/healthz",
    "healthCheckTimeout": 300
  }
}
