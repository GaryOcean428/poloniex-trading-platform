{"version":3,"file":"strategyExecutors-aBpXDD8U.js","sources":["../../src/utils/logger.ts","../../src/utils/strategyExecutors.ts"],"sourcesContent":["/**\n * Logger utility for tracking application events and errors\n */\n\ntype LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\ninterface LogEntry {\n  timestamp: string;\n  level: LogLevel;\n  message: string;\n  data?: unknown;\n}\n\n// Configure log levels that should be output\n// In production, you might want to set this to ['info', 'warn', 'error']\nconst activeLevels: LogLevel[] = ['debug', 'info', 'warn', 'error'];\n\nclass Logger {\n  private static instance: Logger;\n  private logs: LogEntry[] = [];\n  private maxLogs = 1000; // Maximum number of logs to keep in memory\n\n  private constructor() {}\n\n  public static getInstance(): Logger {\n    if (!Logger.instance) {\n      Logger.instance = new Logger();\n    }\n    return Logger.instance;\n  }\n\n  private createLogEntry(level: LogLevel, message: string, data?: unknown): LogEntry {\n    return {\n      timestamp: new Date().toISOString(),\n      level,\n      message,\n      data\n    };\n  }\n\n  private addLog(entry: LogEntry): void {\n    // Add the log to our in-memory store\n    this.logs.push(entry);\n    \n    // Trim logs if they exceed the maximum\n    if (this.logs.length > this.maxLogs) {\n      this.logs = this.logs.slice(-this.maxLogs);\n    }\n    \n    // In a real application, you might want to send logs to a server or service\n    if (activeLevels.includes(entry.level)) {\n      const { timestamp, level, message, data } = entry;\n      console[level === 'error' ? 'error' : level === 'warn' ? 'warn' : 'log'](\n        `[${level.toUpperCase()}] ${timestamp} - ${message}`,\n        data ? data : ''\n      );\n    }\n  }\n\n  public debug(message: string, data?: unknown): void {\n    this.addLog(this.createLogEntry('debug', message, data));\n  }\n\n  public info(message: string, data?: unknown): void {\n    this.addLog(this.createLogEntry('info', message, data));\n  }\n\n  public warn(message: string, data?: unknown): void {\n    this.addLog(this.createLogEntry('warn', message, data));\n  }\n\n  public error(message: string, data?: unknown): void {\n    this.addLog(this.createLogEntry('error', message, data));\n  }\n\n  public getLogs(level?: LogLevel): LogEntry[] {\n    if (level) {\n      return this.logs.filter(log => log.level === level);\n    }\n    return this.logs;\n  }\n\n  public clearLogs(): void {\n    this.logs = [];\n  }\n}\n\nexport const logger = Logger.getInstance();","import { Strategy, MarketData, StrategyParameters, MovingAverageCrossoverParameters, RSIParameters, MACDParameters, BollingerBandsParameters } from '@/types';\nimport { logger } from '@/utils/logger';\n\n// Strategy result\nexport interface StrategyResult {\n  signal: 'BUY' | 'SELL' | null;\n  reason: string;\n  confidence: number;\n}\n\n/**\n * Execute a trading strategy based on market data\n */\nexport function executeStrategy(strategy: Strategy, marketData: MarketData[]): StrategyResult {\n  try {\n    // Add timeframe from strategy if not in parameters\n    const parameters = {\n      ...strategy.parameters,\n      timeframe: strategy.parameters.timeframe || '5m'\n    };\n\n    switch (strategy.type) {\n      case 'MovingAverageCrossover':\n        return executeMovingAverageCrossover(parameters, marketData);\n      case 'RSI':\n        return executeRSI(parameters, marketData);\n      case 'MACD':\n        return executeMACD(parameters, marketData);\n      case 'BollingerBands':\n        return executeBollingerBands(parameters, marketData);\n      case 'Custom':\n        return executeCustomStrategy();\n      default:\n        logger.error(`Unknown strategy type: ${strategy.type}`);\n        return { signal: null, reason: 'Unknown strategy type', confidence: 0 };\n    }\n  } catch (error) {\n    logger.error('Strategy execution error:', error);\n    return { signal: null, reason: 'Strategy execution error', confidence: 0 };\n  }\n}\n\n/**\n * Moving Average Crossover Strategy\n * \n * Parameters:\n * - fastPeriod: Period for fast moving average\n * - slowPeriod: Period for slow moving average\n */\nfunction executeMovingAverageCrossover(\n  parameters: StrategyParameters,\n  marketData: MarketData[]\n): StrategyResult {\n  const params = parameters as MovingAverageCrossoverParameters;\n  const { fastPeriod = 9, slowPeriod = 21 } = params;\n  \n  if (marketData.length < slowPeriod + 2) {\n    return { \n      signal: null, \n      reason: 'Insufficient data for MA calculation', \n      confidence: 0 \n    };\n  }\n  \n  // Calculate fast and slow MAs\n  const fastMA = calculateSMA(marketData, fastPeriod);\n  const slowMA = calculateSMA(marketData, slowPeriod);\n  \n  // Get current and previous values\n  const currentFastMA = fastMA[fastMA.length - 1];\n  const previousFastMA = fastMA[fastMA.length - 2];\n  const currentSlowMA = slowMA[slowMA.length - 1];\n  const previousSlowMA = slowMA[slowMA.length - 2];\n  \n  // Check for crossover\n  const isBullishCrossover = previousFastMA <= previousSlowMA && currentFastMA > currentSlowMA;\n  const isBearishCrossover = previousFastMA >= previousSlowMA && currentFastMA < currentSlowMA;\n  \n  // Calculate confidence based on the distance between MAs\n  const maDifference = Math.abs(currentFastMA - currentSlowMA);\n  const maAverage = (currentFastMA + currentSlowMA) / 2;\n  const confidence = Math.min(0.9, maDifference / maAverage * 10);\n  \n  if (isBullishCrossover) {\n    return {\n      signal: 'BUY',\n      reason: `Bullish crossover: Fast MA (${fastPeriod}) crossed above Slow MA (${slowPeriod})`,\n      confidence\n    };\n  } else if (isBearishCrossover) {\n    return {\n      signal: 'SELL',\n      reason: `Bearish crossover: Fast MA (${fastPeriod}) crossed below Slow MA (${slowPeriod})`,\n      confidence\n    };\n  }\n  \n  return {\n    signal: null,\n    reason: 'No crossover detected',\n    confidence: 0\n  };\n}\n\n/**\n * RSI Strategy\n * \n * Parameters:\n * - period: Period for RSI calculation\n * - overbought: Overbought threshold\n * - oversold: Oversold threshold\n */\nfunction executeRSI(\n  parameters: StrategyParameters,\n  marketData: MarketData[]\n): StrategyResult {\n  const params = parameters as RSIParameters;\n  const { period = 14, overbought = 70, oversold = 30 } = params;\n  \n  if (marketData.length < period + 1) {\n    return { \n      signal: null, \n      reason: 'Insufficient data for RSI calculation', \n      confidence: 0 \n    };\n  }\n  \n  // Calculate RSI\n  const rsi = calculateRSI(marketData, period);\n  const currentRSI = rsi[rsi.length - 1];\n  const previousRSI = rsi[rsi.length - 2];\n  \n  // Calculate confidence based on distance from thresholds\n  let confidence = 0;\n  \n  if (currentRSI < oversold) {\n    confidence = Math.min(0.9, (oversold - currentRSI) / oversold);\n    \n    // Check if RSI is turning up from oversold\n    if (previousRSI < currentRSI) {\n      return {\n        signal: 'BUY',\n        reason: `RSI (${currentRSI.toFixed(2)}) turning up from oversold zone (${oversold})`,\n        confidence\n      };\n    }\n  } else if (currentRSI > overbought) {\n    confidence = Math.min(0.9, (currentRSI - overbought) / (100 - overbought));\n    \n    // Check if RSI is turning down from overbought\n    if (previousRSI > currentRSI) {\n      return {\n        signal: 'SELL',\n        reason: `RSI (${currentRSI.toFixed(2)}) turning down from overbought zone (${overbought})`,\n        confidence\n      };\n    }\n  }\n  \n  return {\n    signal: null,\n    reason: `RSI (${currentRSI.toFixed(2)}) is in neutral zone`,\n    confidence: 0\n  };\n}\n\n/**\n * MACD Strategy\n * \n * Parameters:\n * - fastPeriod: Period for fast EMA\n * - slowPeriod: Period for slow EMA\n * - signalPeriod: Period for signal line\n */\nfunction executeMACD(\n  parameters: StrategyParameters,\n  marketData: MarketData[]\n): StrategyResult {\n  const params = parameters as MACDParameters;\n  const { fastPeriod = 12, slowPeriod = 26, signalPeriod = 9 } = params;\n  \n  if (marketData.length < slowPeriod + signalPeriod) {\n    return { \n      signal: null, \n      reason: 'Insufficient data for MACD calculation', \n      confidence: 0 \n    };\n  }\n  \n  // Calculate MACD\n  const macdResult = calculateMACD(\n    marketData, \n    fastPeriod, \n    slowPeriod, \n    signalPeriod\n  );\n  \n  const currentHistogram = macdResult.histogram[macdResult.histogram.length - 1];\n  const previousHistogram = macdResult.histogram[macdResult.histogram.length - 2];\n  \n  // Calculate confidence based on histogram value\n  const confidence = Math.min(0.9, Math.abs(currentHistogram) / 0.5);\n  \n  // Check for crossover\n  if (previousHistogram <= 0 && currentHistogram > 0) {\n    return {\n      signal: 'BUY',\n      reason: 'MACD histogram turned positive (bullish crossover)',\n      confidence\n    };\n  } else if (previousHistogram >= 0 && currentHistogram < 0) {\n    return {\n      signal: 'SELL',\n      reason: 'MACD histogram turned negative (bearish crossover)',\n      confidence\n    };\n  }\n  \n  return {\n    signal: null,\n    reason: 'No MACD crossover detected',\n    confidence: 0\n  };\n}\n\n/**\n * Bollinger Bands Strategy\n * \n * Parameters:\n * - period: Period for moving average\n * - stdDev: Number of standard deviations\n */\nfunction executeBollingerBands(\n  parameters: StrategyParameters,\n  marketData: MarketData[]\n): StrategyResult {\n  const params = parameters as BollingerBandsParameters;\n  const { period = 20, stdDev = 2 } = params;\n  \n  if (marketData.length < period) {\n    return { \n      signal: null, \n      reason: 'Insufficient data for Bollinger Bands calculation', \n      confidence: 0 \n    };\n  }\n  \n  // Calculate Bollinger Bands\n  const bands = calculateBollingerBands(marketData, period, stdDev);\n  \n  const currentPrice = marketData[marketData.length - 1].close;\n  const previousPrice = marketData[marketData.length - 2].close;\n  \n  const currentUpper = bands.upper[bands.upper.length - 1];\n  const currentLower = bands.lower[bands.lower.length - 1];\n  // Middle band value not used in this function\n  \n  // Calculate confidence based on position within bands\n  let confidence = 0;\n  \n  if (currentPrice < currentLower) {\n    confidence = Math.min(0.9, (currentLower - currentPrice) / (currentLower * 0.05));\n    \n    // Check if price is bouncing up from lower band\n    if (previousPrice < currentPrice) {\n      return {\n        signal: 'BUY',\n        reason: 'Price bouncing up from lower Bollinger Band',\n        confidence\n      };\n    }\n  } else if (currentPrice > currentUpper) {\n    confidence = Math.min(0.9, (currentPrice - currentUpper) / (currentUpper * 0.05));\n    \n    // Check if price is bouncing down from upper band\n    if (previousPrice > currentPrice) {\n      return {\n        signal: 'SELL',\n        reason: 'Price bouncing down from upper Bollinger Band',\n        confidence\n      };\n    }\n  }\n  \n  return {\n    signal: null,\n    reason: 'Price within Bollinger Bands, no signal',\n    confidence: 0\n  };\n}\n\n/**\n * Custom Strategy\n * \n * This is a placeholder for user-defined strategies\n */\nfunction executeCustomStrategy(\n  // Remove unused parameters to fix type errors\n): StrategyResult {\n  // This is where users can implement their own strategy logic\n  return {\n    signal: null,\n    reason: 'Custom strategy not implemented',\n    confidence: 0\n  };\n}\n\n// Technical indicator calculations\n\n/**\n * Calculate Simple Moving Average (SMA)\n */\nfunction calculateSMA(marketData: MarketData[], period: number): number[] {\n  const prices = marketData.map(candle => candle.close);\n  const sma = [];\n  \n  for (let i = period - 1; i < prices.length; i++) {\n    const sum = prices.slice(i - period + 1, i + 1).reduce((a, b) => a + b, 0);\n    sma.push(sum / period);\n  }\n  \n  return sma;\n}\n\n/**\n * Calculate Exponential Moving Average (EMA)\n */\nfunction calculateEMA(marketData: MarketData[], period: number): number[] {\n  const prices = marketData.map(candle => candle.close);\n  const ema = [];\n  const multiplier = 2 / (period + 1);\n  \n  // Start with SMA\n  const firstSMA = prices.slice(0, period).reduce((a, b) => a + b, 0) / period;\n  ema.push(firstSMA);\n  \n  // Calculate EMA\n  for (let i = period; i < prices.length; i++) {\n    ema.push((prices[i] - ema[ema.length - 1]) * multiplier + ema[ema.length - 1]);\n  }\n  \n  return ema;\n}\n\n/**\n * Calculate Relative Strength Index (RSI)\n */\nfunction calculateRSI(marketData: MarketData[], period: number): number[] {\n  const prices = marketData.map(candle => candle.close);\n  const gains = [];\n  const losses = [];\n  const rsi = [];\n  \n  // Calculate price changes\n  for (let i = 1; i < prices.length; i++) {\n    const change = prices[i] - prices[i - 1];\n    gains.push(change > 0 ? change : 0);\n    losses.push(change < 0 ? -change : 0);\n  }\n  \n  // Calculate initial averages\n  let avgGain = gains.slice(0, period).reduce((a, b) => a + b, 0) / period;\n  let avgLoss = losses.slice(0, period).reduce((a, b) => a + b, 0) / period;\n  \n  // Calculate first RSI\n  let rs = avgGain / (avgLoss === 0 ? 0.001 : avgLoss); // Avoid division by zero\n  rsi.push(100 - (100 / (1 + rs)));\n  \n  // Calculate remaining RSIs\n  for (let i = period; i < gains.length; i++) {\n    avgGain = ((avgGain * (period - 1)) + gains[i]) / period;\n    avgLoss = ((avgLoss * (period - 1)) + losses[i]) / period;\n    \n    rs = avgGain / (avgLoss === 0 ? 0.001 : avgLoss);\n    rsi.push(100 - (100 / (1 + rs)));\n  }\n  \n  return rsi;\n}\n\n/**\n * Calculate MACD (Moving Average Convergence Divergence)\n */\nfunction calculateMACD(\n  marketData: MarketData[],\n  fastPeriod: number,\n  slowPeriod: number,\n  signalPeriod: number\n): { macd: number[], signal: number[], histogram: number[] } {\n  // Calculate EMAs\n  const fastEMA = calculateEMA(marketData, fastPeriod);\n  const slowEMA = calculateEMA(marketData, slowPeriod);\n  \n  // Calculate MACD line\n  const macd = [];\n  for (let i = 0; i < fastEMA.length; i++) {\n    if (i >= slowEMA.length - fastEMA.length) {\n      macd.push(fastEMA[i] - slowEMA[i - (slowEMA.length - fastEMA.length)]);\n    }\n  }\n  \n  // Calculate signal line (EMA of MACD)\n  const signal = [];\n  const multiplier = 2 / (signalPeriod + 1);\n  \n  // Start with SMA of MACD\n  const firstSignalSMA = macd.slice(0, signalPeriod).reduce((a, b) => a + b, 0) / signalPeriod;\n  signal.push(firstSignalSMA);\n  \n  // Calculate signal EMA\n  for (let i = signalPeriod; i < macd.length; i++) {\n    signal.push((macd[i] - signal[signal.length - 1]) * multiplier + signal[signal.length - 1]);\n  }\n  \n  // Calculate histogram\n  const histogram = [];\n  for (let i = 0; i < signal.length; i++) {\n    histogram.push(macd[i + (macd.length - signal.length)] - signal[i]);\n  }\n  \n  return { macd, signal, histogram };\n}\n\n/**\n * Calculate Bollinger Bands\n */\nfunction calculateBollingerBands(\n  marketData: MarketData[],\n  period: number,\n  stdDev: number\n): { middle: number[], upper: number[], lower: number[] } {\n  const prices = marketData.map(candle => candle.close);\n  const middle = calculateSMA(marketData, period);\n  const upper = [];\n  const lower = [];\n  \n  for (let i = period - 1; i < prices.length; i++) {\n    const slice = prices.slice(i - period + 1, i + 1);\n    const sum = slice.reduce((a, b) => a + b, 0);\n    const mean = sum / period;\n    \n    // Calculate standard deviation\n    const squaredDiffs = slice.map(price => Math.pow(price - mean, 2));\n    const variance = squaredDiffs.reduce((a, b) => a + b, 0) / period;\n    const standardDeviation = Math.sqrt(variance);\n    \n    upper.push(middle[i - (period - 1)] + (standardDeviation * stdDev));\n    lower.push(middle[i - (period - 1)] - (standardDeviation * stdDev));\n  }\n  \n  return { middle, upper, lower };\n}\n"],"names":["activeLevels","_Logger","__publicField","level","message","data","entry","timestamp","log","Logger","logger","executeStrategy","strategy","marketData","parameters","executeMovingAverageCrossover","executeRSI","executeMACD","executeBollingerBands","executeCustomStrategy","error","params","fastPeriod","slowPeriod","fastMA","calculateSMA","slowMA","currentFastMA","previousFastMA","currentSlowMA","previousSlowMA","isBullishCrossover","isBearishCrossover","maDifference","maAverage","confidence","period","overbought","oversold","rsi","calculateRSI","currentRSI","previousRSI","signalPeriod","macdResult","calculateMACD","currentHistogram","previousHistogram","stdDev","bands","calculateBollingerBands","currentPrice","previousPrice","currentUpper","currentLower","prices","candle","sma","i","sum","a","b","calculateEMA","ema","multiplier","firstSMA","gains","losses","change","avgGain","avgLoss","rs","fastEMA","slowEMA","macd","signal","firstSignalSMA","histogram","middle","upper","lower","slice","mean","variance","price","standardDeviation"],"mappings":"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"}